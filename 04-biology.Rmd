# Biology {#biology}

## General
Some helpful commands for genetic sequence.
```{python eval=FALSE}
from string import ascii_uppercase # python 3
from string import upper, lower # python 2
upper('tcga')
lower('TCGA')
title('tcga') # capitalize the first letter
```

## Biopython 
Reverse complement of sequence
```{python eval=FALSE}
from Bio.Seq import Seq
str(Seq(i).reverse_complement())
```

## UCSC Genome Browser
Get sequence from UCSC genome browser
```{python eval=FALSE}
from subprocess import check_output, STDOUT
temp = check_output('wget -qO- http://genome.ucsc.edu/cgi-bin/das/hg19/dna?segment=%s:%s,%s' % (vcfObj.chrom,low,high), stderr=STDOUT, shell=True)
```

If the reference genome comes in the .2bit format, it is likely that it should then be converted to .fa format, and .2bittofa can accomplish this.
```{python eval=FALSE}
twoBitToFa refgenomes/hg19.2bit refgenomes/hg19.fa
```

The newly created .fa file will need to be indexed if it is to be used with gatk and bwa mem.

Here is an example of indexing where -a bwtsw specifies that we want to use the indexing algorithm that is capable of handling the whole human genome.
```{python eval=FALSE}
bwa index -a bwtsw reference.fa
```

Then create a file called reference.fa.fai, with one record per line for each of the contigs in the FASTA reference file. Each record is composed of the contig name, size, location, basesPerLine and bytesPerLine.
```{python eval=FALSE}
samtools faidx reference.fa
```

## Ref Genome
Get sequence from reference genome
```{python eval=FALSE}
from subprocess import check_output, STDOUT
temp = check_output('samtools faidx %s %s:%s-%s' % (ref, vcfObj.chrom, low, high), stderr=STDOUT, shell=True)

finalSeq = ''
for line in temp.decode('UTF-8').split('\n'):
for line in temp.decode('UTF-8').split('\n'): # this is only necessary in python 3 to convert binary to string
	if '>' not in line:
		finalSeq += line

finalSeq = finalSeq.upper()
```

## Personal Information
```{python eval=FALSE}
# parse vcf file with parseline
if '#' not in line and 'chr' in line: # skip the info
# vcf handling
from parseline import VCFObj
# or
from util import VCFObj
vcfObj = VCFObj(vcfLine)
# available attributes: ao, dp, af, wt, var, chrom, location
```

## GATK
The entire set of GATK software can be downloaded together [here]('https://software.broadinstitute.org/gatk/').  
Methods and algorithms as they are run at the Broad can be found [here]('https://software.broadinstitute.org/gatk/documentation/topic?name=methods').  
The Broad also has a number of [tutorials]('https://software.broadinstitute.org/gatk/documentation/topic?name=tutorials') that introduce some of the software packaged within GATK. 
### Mutect2
A [tutorial]('https://software.broadinstitute.org/gatk/documentation/article?id=24057') exists that introduces how Mutext2 can be used to call somatic mutations.
