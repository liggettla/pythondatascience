\documentclass[]{book}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Data Science With Python},
            pdfauthor={L A Liggett},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{natbib}
\bibliographystyle{apalike}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\usepackage{longtable,booktabs}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{Data Science With Python}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{L A Liggett}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
      \predate{\centering\large\emph}
  \postdate{\par}
    \date{2019-06-24}

\usepackage{booktabs}
\usepackage{amsthm}
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=8pt plus 2pt minus 4pt
  \thm@postskip=\thm@preskip
}
\makeatother

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\chapter{Overview}\label{overview}

These are some notes that may be helpful for computational biology
analysis that focuses on Python use.

\chapter{Python}\label{python}

\section{General}\label{general}

Here is a general skeleton that can be used to start a python script
that takes input.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#!/usr/bin/env python}

\KeywordTok{def}\NormalTok{ runArgparse():}
\ImportTok{import}\NormalTok{ argparse}

\NormalTok{parser }\OperatorTok{=}\NormalTok{ argparse.ArgumentParser()}
\NormalTok{parser.add_argument(}\StringTok{'--indir'}\NormalTok{, }\StringTok{'-i'}\NormalTok{, }\BuiltInTok{type}\OperatorTok{=}\BuiltInTok{str}\NormalTok{, nargs}\OperatorTok{=}\StringTok{'*'}\NormalTok{, }\BuiltInTok{help}\OperatorTok{=}\StringTok{'Input directory containing the vcf files to be analyzed: /dir.'}\NormalTok{)}
\NormalTok{parser.add_argument(}\StringTok{'--loadolddata'}\NormalTok{, }\StringTok{'-o'}\NormalTok{, action}\OperatorTok{=}\StringTok{'store_true'}\NormalTok{, }\BuiltInTok{help}\OperatorTok{=}\StringTok{'Load previously existing data.'}\NormalTok{)}

\NormalTok{args }\OperatorTok{=}\NormalTok{ parser.parse_args()}
\NormalTok{indir }\OperatorTok{=}\NormalTok{ args.indir}
\ControlFlowTok{return}\NormalTok{ indir}

\ControlFlowTok{if} \VariableTok{__name__} \OperatorTok{==} \StringTok{'__main__'}\NormalTok{:}
\NormalTok{    runArgparse()}
\end{Highlighting}
\end{Shaded}

\section{Numba}\label{numba}

Numba speeds up python code without having to switch to a different
interpreter, and doesn't require static typing of variables as Cython
does. Just calling Numba will increase the speed of a script (except
during the compilation which will add some time). But this isn't the
best way to take advantage of the speed boost.

Here is an example script that uses jit to invoke Numba.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#!/usr/bin/env python}

\ImportTok{from}\NormalTok{ numba }\ImportTok{import}\NormalTok{ jit}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{import}\NormalTok{ time}

\KeywordTok{def}\NormalTok{ go_slow(x):}
    \ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{14}\NormalTok{):}
\NormalTok{        x }\OperatorTok{*=}\NormalTok{ x}

\AttributeTok{@jit}\NormalTok{(nopython}\OperatorTok{=}\VariableTok{True}\NormalTok{)}
\KeywordTok{def}\NormalTok{ go_fast(x):}
    \ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{14}\NormalTok{):}
\NormalTok{        x }\OperatorTok{*=}\NormalTok{ x}

\CommentTok{# DO NOT REPORT THIS... COMPILATION TIME IS INCLUDED IN THE EXECUTION TIME!}
\NormalTok{start }\OperatorTok{=}\NormalTok{ time.time()}
\NormalTok{go_slow(}\DecValTok{5}\NormalTok{)}
\NormalTok{end }\OperatorTok{=}\NormalTok{ time.time()}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Elapsed slow (with compilation) = }\SpecialCharTok{%s}\StringTok{"} \OperatorTok{%}\NormalTok{ (end }\OperatorTok{-}\NormalTok{ start))}
\NormalTok{start }\OperatorTok{=}\NormalTok{ time.time()}
\NormalTok{go_fast(}\DecValTok{5}\NormalTok{)}
\NormalTok{end }\OperatorTok{=}\NormalTok{ time.time()}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Elapsed fast (with compilation) = }\SpecialCharTok{%s}\StringTok{"} \OperatorTok{%}\NormalTok{ (end }\OperatorTok{-}\NormalTok{ start))}

\CommentTok{# DO NOT REPORT THIS... COMPILATION TIME IS INCLUDED IN THE EXECUTION TIME!}
\NormalTok{start }\OperatorTok{=}\NormalTok{ time.time()}
\NormalTok{go_slow(}\DecValTok{5}\NormalTok{)}
\NormalTok{end }\OperatorTok{=}\NormalTok{ time.time()}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Elapsed slow (after compilation) = }\SpecialCharTok{%s}\StringTok{"} \OperatorTok{%}\NormalTok{ (end }\OperatorTok{-}\NormalTok{ start))}
\NormalTok{start }\OperatorTok{=}\NormalTok{ time.time()}
\NormalTok{go_fast(}\DecValTok{5}\NormalTok{)}
\NormalTok{end }\OperatorTok{=}\NormalTok{ time.time()}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Elapsed fast (after compilation) = }\SpecialCharTok{%s}\StringTok{"} \OperatorTok{%}\NormalTok{ (end }\OperatorTok{-}\NormalTok{ start))}
\end{Highlighting}
\end{Shaded}

Parallelization can be used to automatically utilize multiple cores.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ numba }\ImportTok{import}\NormalTok{ njit, prange}
\AttributeTok{@njit}\NormalTok{(parallel}\OperatorTok{=}\VariableTok{True}\NormalTok{)}
\KeywordTok{def}\NormalTok{ prange_test(A):}
\NormalTok{    s }\OperatorTok{=} \DecValTok{0}
    \ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in}\NormalTok{ prange(A.shape[}\DecValTok{0}\NormalTok{]):}
\NormalTok{        s }\OperatorTok{+=}\NormalTok{ A[i]}
    \ControlFlowTok{return}\NormalTok{ s}
\end{Highlighting}
\end{Shaded}

\section{Cython}\label{cython}

Installation

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{conda install }\OperatorTok{-}\NormalTok{c conda}\OperatorTok{-}\NormalTok{forge cython}
\end{Highlighting}
\end{Shaded}

Ipython usage

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{%}\NormalTok{load_ext Cython}

\OperatorTok{%%}\NormalTok{cython}
\KeywordTok{def}\NormalTok{ f(x):}
    \ControlFlowTok{return} \DecValTok{2} \OperatorTok{*}\NormalTok{ x}
\KeywordTok{or}

\KeywordTok{def}\NormalTok{ f(}\BuiltInTok{int}\NormalTok{ x):}
    \ControlFlowTok{return} \DecValTok{2} \OperatorTok{*}\NormalTok{ x}

\NormalTok{timeit(f(}\DecValTok{4}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\chapter{JupyterLab}\label{jupyter}

Here is a simple template that I use that controls a couple useful
things when starting a new notebook.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ sys}
\NormalTok{sys.path.append(}\StringTok{'../util'}\NormalTok{)}

\OperatorTok{%}\NormalTok{reload_ext autoreload}
\OperatorTok{%}\NormalTok{autoreload }\DecValTok{2}

\ImportTok{from}\NormalTok{ util }\ImportTok{import} \OperatorTok{*}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np                  }
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd                 }
\ImportTok{from}\NormalTok{ matplotlib }\ImportTok{import}\NormalTok{ pyplot }\ImportTok{as}\NormalTok{ plt}
\ImportTok{import}\NormalTok{ seaborn }\ImportTok{as}\NormalTok{ sns}

\NormalTok{sns.set_palette(}\StringTok{'pastel'}\NormalTok{)}
\NormalTok{sns.set_style(}\StringTok{'ticks'}\NormalTok{)}
\NormalTok{sns.set_context(}\StringTok{'paper'}\NormalTok{, font_scale}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

It is often convenient to have a notebook automatically refresh the
imported libraries so that they can be modified while working on a
JupyterLab notebook.

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{%}\NormalTok{reload_ext autoreload}
\OperatorTok{%}\NormalTok{autoreload }\DecValTok{2}
\end{Highlighting}
\end{Shaded}

To allow directory organization, dependcies can be separated into
different directories and imported into a jupyter notebook using the
following import statement.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ sys}
\NormalTok{sys.path.append(}\StringTok{'../util'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

A table of contents can be created to refer to each of the headers
throughout a notebook in html format. The code is below (Obviously needs
to be simplified.)

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{<h1>}\NormalTok{Table of Contents}\KeywordTok{<span}\OtherTok{ class=}\StringTok{"tocSkip"}\KeywordTok{></span></h1>}
\KeywordTok{<div}\OtherTok{ class=}\StringTok{"toc"}\KeywordTok{>}
    \KeywordTok{<ul}\OtherTok{ class=}\StringTok{"toc-item"}\KeywordTok{>}
    \KeywordTok{<li>}
        \KeywordTok{<span><a}\OtherTok{ href=}\StringTok{"#Python-Setup"}\OtherTok{ data-toc-modified-id=}\StringTok{"Python-Setup-1"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{1}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Python Setup}\KeywordTok{</a></span>}
        \KeywordTok{<ul}\OtherTok{ class=}\StringTok{"toc-item"}\KeywordTok{>}
    \KeywordTok{<li>}
        \KeywordTok{<span><a}\OtherTok{ href=}\StringTok{"#Change-the-width-of-the-page"}\OtherTok{ data-toc-modified-id=}\StringTok{"Change-the-width-of-the-page-1.1"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{1.1}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Change the width of the page}\KeywordTok{</a></span></li>}
        \KeywordTok{<li>}
            \KeywordTok{<span><a}\OtherTok{ href=}\StringTok{"#Import-packages"}\OtherTok{ data-toc-modified-id=}\StringTok{"Import-packages-1.2"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{1.2}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Import packages}\KeywordTok{</a></span></li>}
        \KeywordTok{</ul>}
    \KeywordTok{</li>}
    \KeywordTok{<li>}
        \KeywordTok{<span><a}\OtherTok{ href=}\StringTok{"#Colours"}\OtherTok{ data-toc-modified-id=}\StringTok{"Colours-2"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{2}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Colours}\KeywordTok{</a></span>}
        \KeywordTok{<ul}\OtherTok{ class=}\StringTok{"toc-item"}\KeywordTok{>}
    \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Colour-line-graph"}\OtherTok{ data-toc-modified-id=}\StringTok{"Colour-line-graph-2.1"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{2.1}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Colour line graph}\KeywordTok{</a></span></li>}
        \KeywordTok{</ul>}
    \KeywordTok{</li>}
    \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Totals-for-studies"}\OtherTok{ data-toc-modified-id=}\StringTok{"Totals-for-studies-3"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{3}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Totals for studies}\KeywordTok{</a></span></li>}
    \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Functions-for-calculating-trinucleotide-context-specific-mutation-rates"}\OtherTok{ data-toc-modified-id=}\StringTok{"Functions-for-calculating-trinucleotide-context-specific-mutation-rates-4"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{4}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Functions for calculating trinucleotide-context specific mutation rates}\KeywordTok{</a></span>}
        \KeywordTok{<ul}\OtherTok{ class=}\StringTok{"toc-item"}\KeywordTok{>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Calculating-mutation-rates-for-individual-variants"}\OtherTok{ data-toc-modified-id=}\StringTok{"Calculating-mutation-rates-for-individual-variants-4.1"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{4.1}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Calculating mutation rates for individual variants}\KeywordTok{</a></span>}
            \KeywordTok{<ul}\OtherTok{ class=}\StringTok{"toc-item"}\KeywordTok{>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#DNMT3A"}\OtherTok{ data-toc-modified-id=}\StringTok{"DNMT3A-4.1.1"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{4.1.1}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{DNMT3A}\KeywordTok{</a></span></li>}
            \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#TET2"}\OtherTok{ data-toc-modified-id=}\StringTok{"TET2-4.1.2"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{4.1.2}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{TET2}\KeywordTok{</a></span></li>}
            \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#ASXL1"}\OtherTok{ data-toc-modified-id=}\StringTok{"ASXL1-4.1.3"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{4.1.3}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{ASXL1}\KeywordTok{</a></span></li>}
            \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#TP53"}\OtherTok{ data-toc-modified-id=}\StringTok{"TP53-4.1.4"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{4.1.4}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{TP53}\KeywordTok{</a></span></li></ul></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Calculating-mutation-rates-from-a-.csv-file-of-variants"}\OtherTok{ data-toc-modified-id=}\StringTok{"Calculating-mutation-rates-from-a-.csv-file-of-variants-4.2"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{4.2}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Calculating mutation rates from a .csv file of variants}\KeywordTok{</a></span>}
            \KeywordTok{<ul}\OtherTok{ class=}\StringTok{"toc-item"}\KeywordTok{>}
            \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#DNMT3A"}\OtherTok{ data-toc-modified-id=}\StringTok{"DNMT3A-4.2.1"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{4.2.1}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{DNMT3A}\KeywordTok{</a></span></li>}
            \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#TET2"}\OtherTok{ data-toc-modified-id=}\StringTok{"TET2-4.2.2"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{4.2.2}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{TET2}\KeywordTok{</a></span></li>}
            \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#ASXL1"}\OtherTok{ data-toc-modified-id=}\StringTok{"ASXL1-4.2.3"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{4.2.3}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{ASXL1}\KeywordTok{</a></span></li>}
            \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#TP53"}\OtherTok{ data-toc-modified-id=}\StringTok{"TP53-4.2.4"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{4.2.4}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{TP53}\KeywordTok{</a></span></li></ul></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Calculating-mutation-rates-from-a-list-of-variants"}\OtherTok{ data-toc-modified-id=}\StringTok{"Calculating-mutation-rates-from-a-list-of-variants-4.3"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{4.3}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Calculating mutation rates from a list of variants}\KeywordTok{</a></span>}
            \KeywordTok{<ul}\OtherTok{ class=}\StringTok{"toc-item"}\KeywordTok{>}
            \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#DNMT3A"}\OtherTok{ data-toc-modified-id=}\StringTok{"DNMT3A-4.3.1"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{4.3.1}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{DNMT3A}\KeywordTok{</a></span></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#TET2"}\OtherTok{ data-toc-modified-id=}\StringTok{"TET2-4.3.2"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{4.3.2}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{TET2}\KeywordTok{</a></span></li>}
            \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#ASXL1"}\OtherTok{ data-toc-modified-id=}\StringTok{"ASXL1-4.3.3"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{4.3.3}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{ASXL1}\KeywordTok{</a></span></li>}
            \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#TP53"}\OtherTok{ data-toc-modified-id=}\StringTok{"TP53-4.3.4"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{4.3.4}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{TP53}\KeywordTok{</a></span></li></ul></li></ul></li>}
    \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Lists-of-variants-targeted-by-each-study"}\OtherTok{ data-toc-modified-id=}\StringTok{"Lists-of-variants-targeted-by-each-study-5"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{5}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Lists of variants targeted by each study}\KeywordTok{</a></span><ul}\OtherTok{ class=}\StringTok{"toc-item"}\KeywordTok{><li><span><a}\OtherTok{ href=}\StringTok{"#Jaiswal-2014"}\OtherTok{ data-toc-modified-id=}\StringTok{"Jaiswal-2014-5.1"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{5.1}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Jaiswal 2014}\KeywordTok{</a></span></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Genovese-2014"}\OtherTok{ data-toc-modified-id=}\StringTok{"Genovese-2014-5.2"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{5.2}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Genovese 2014}\KeywordTok{</a></span></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#McKerrel-2015"}\OtherTok{ data-toc-modified-id=}\StringTok{"McKerrel-2015-5.3"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{5.3}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{McKerrel 2015}\KeywordTok{</a></span></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Zink-2017"}\OtherTok{ data-toc-modified-id=}\StringTok{"Zink-2017-5.4"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{5.4}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Zink 2017}\KeywordTok{</a></span></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Coombs-2017"}\OtherTok{ data-toc-modified-id=}\StringTok{"Coombs-2017-5.5"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{5.5}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Coombs 2017}\KeywordTok{</a></span></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Young-2016-}\DecValTok{&amp;}\StringTok{-2019"}\OtherTok{ data-toc-modified-id=}\StringTok{"Young-2016-}\DecValTok{&amp;}\StringTok{-2019-5.6"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{5.6}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Young 2016 }\DecValTok{&amp;}\NormalTok{ 2019}\KeywordTok{</a></span></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Desai-2018"}\OtherTok{ data-toc-modified-id=}\StringTok{"Desai-2018-5.7"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{5.7}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Desai 2018}\KeywordTok{</a></span></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Acuna-Hidalgo-2017"}\OtherTok{ data-toc-modified-id=}\StringTok{"Acuna-Hidalgo-2017-5.8"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{5.8}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Acuna-Hidalgo 2017}\KeywordTok{</a></span></li></ul></li>}
    \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Lists-of-all-possible-variants-in-DNMT3A,-TET2,-ASXL1,-TP53"}\OtherTok{ data-toc-modified-id=}\StringTok{"Lists-of-all-possible-variants-in-DNMT3A,-TET2,-ASXL1,-TP53-6"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{6}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Lists of all possible variants in DNMT3A, TET2, ASXL1, TP53}\KeywordTok{</a></span>}
        \KeywordTok{<ul}\OtherTok{ class=}\StringTok{"toc-item"}\KeywordTok{>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#DNMT3A"}\OtherTok{ data-toc-modified-id=}\StringTok{"DNMT3A-6.1"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{6.1}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{DNMT3A}\KeywordTok{</a></span></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#TET2"}\OtherTok{ data-toc-modified-id=}\StringTok{"TET2-6.2"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{6.2}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{TET2}\KeywordTok{</a></span></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#ASXL1"}\OtherTok{ data-toc-modified-id=}\StringTok{"ASXL1-6.3"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{6.3}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{ASXL1}\KeywordTok{</a></span></li>}
    \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#TP53"}\OtherTok{ data-toc-modified-id=}\StringTok{"TP53-6.4"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{6.4}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{TP53}\KeywordTok{</a></span></li></ul></li>}
    \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Actual-number-of-observations-of-each-variant"}\OtherTok{ data-toc-modified-id=}\StringTok{"Actual-number-of-observations-of-each-variant-7"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{7}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Actual number of observations of each variant}\KeywordTok{</a></span>}
        \KeywordTok{<ul}\OtherTok{ class=}\StringTok{"toc-item"}\KeywordTok{>}
        \KeywordTok{<li>}
            \KeywordTok{<ul}\OtherTok{ class=}\StringTok{"toc-item"}\KeywordTok{>}
            \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#DNMT3A"}\OtherTok{ data-toc-modified-id=}\StringTok{"DNMT3A-7.0.1"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{7.0.1}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{DNMT3A}\KeywordTok{</a></span></li>}
            \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#TET2"}\OtherTok{ data-toc-modified-id=}\StringTok{"TET2-7.0.2"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{7.0.2}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{TET2}\KeywordTok{</a></span></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#ASXL1"}\OtherTok{ data-toc-modified-id=}\StringTok{"ASXL1-7.0.3"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{7.0.3}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{ASXL1}\KeywordTok{</a></span></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#TP53"}\OtherTok{ data-toc-modified-id=}\StringTok{"TP53-7.0.4"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{7.0.4}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{TP53}\KeywordTok{</a></span></li></ul></li></ul></li>}
    \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Functions-for-calculating-the-expected-number-of-observations-of-a-variant"}\OtherTok{ data-toc-modified-id=}\StringTok{"Functions-for-calculating-the-expected-number-of-observations-of-a-variant-8"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{8}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Functions for calculating the expected number of observations of a variant}\KeywordTok{</a></span></li>}
    \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#Maximum-Likelihood-Estimation-for-s"}\OtherTok{ data-toc-modified-id=}\StringTok{"Maximum-Likelihood-Estimation-for-s-9"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{9}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{Maximum Likelihood Estimation for s}\KeywordTok{</a></span>}
        \KeywordTok{<ul}\OtherTok{ class=}\StringTok{"toc-item"}\KeywordTok{><li><span><a}\OtherTok{ href=}\StringTok{"#DNMT3A-variants"}\OtherTok{ data-toc-modified-id=}\StringTok{"DNMT3A-variants-9.1"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{9.1}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{DNMT3A variants}\KeywordTok{</a></span></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#TET2-variants"}\OtherTok{ data-toc-modified-id=}\StringTok{"TET2-variants-9.2"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{9.2}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{TET2 variants}\KeywordTok{</a></span></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#ASXL1-variants"}\OtherTok{ data-toc-modified-id=}\StringTok{"ASXL1-variants-9.3"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{9.3}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{ASXL1 variants}\KeywordTok{</a></span></li>}
        \KeywordTok{<li><span><a}\OtherTok{ href=}\StringTok{"#TP53-variants"}\OtherTok{ data-toc-modified-id=}\StringTok{"TP53-variants-9.4"}\KeywordTok{><span}\OtherTok{ class=}\StringTok{"toc-item-num"}\KeywordTok{>}\NormalTok{9.4}\DecValTok{&nbsp;&nbsp;}\KeywordTok{</span>}\NormalTok{TP53 variants}\KeywordTok{</a></span></li>}
        \KeywordTok{</ul>}
        \KeywordTok{</li>}
    \KeywordTok{</ul>}
\KeywordTok{</div>}
\end{Highlighting}
\end{Shaded}

\chapter{Visualization}\label{visualization}

\section{Color}\label{color}

\subsection{Colorschemes}\label{colorschemes}

Seaborn Themes

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Pastel: \{}\StringTok{'Blue'}\NormalTok{:}\StringTok{'#a3c6ff'}\NormalTok{, }\StringTok{'Orange'}\NormalTok{:}\StringTok{'#f7ab60'}\NormalTok{, }\StringTok{'Green'}\NormalTok{:}\StringTok{'#60f7a9'}\NormalTok{, }\StringTok{'Red'}\NormalTok{:}\StringTok{'#fc9d94'}\NormalTok{, }\StringTok{'Purple'}\NormalTok{:}\StringTok{'#bea3ff'}\NormalTok{, }\StringTok{'Brown'}\NormalTok{:}\StringTok{'#d1b485'}\NormalTok{, }\StringTok{'Pink'}\NormalTok{:}\StringTok{'#f7afdf'}\NormalTok{, }\StringTok{'Gray'}\NormalTok{:}\StringTok{'#c4c4c4'}\NormalTok{, }\StringTok{'Yellow'}\NormalTok{:}\StringTok{'#ffffaa'}\NormalTok{, }\StringTok{'LBlue'}\NormalTok{:}\StringTok{'#baf6ff'}\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Deep: \{}\StringTok{'Green'}\NormalTok{:}\StringTok{'#5baf68'}\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\subsection{Controlling Coloration}\label{controlling-coloration}

Not all plots automatically plot with a white background, and when using
something dark like jupyterlab or a presentation this can be
frustrating. The background color can be set in pyplot like this.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fig.patch.set_facecolor(}\StringTok{'xkcd:mint green'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

When plotting, samples will not always be colored with the same color,
especially when different subsets of samples are included in different
plots. Here is a manual workaround to specify the coloration of
displayed data. This is a bit cumbersome so there might be a more
elegant way of achieving the same outcome.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# here is an example where sample order is controlled from a pandas DataFrame}
\NormalTok{sample_order }\OperatorTok{=}\NormalTok{ all_vars.sort_values([}\StringTok{'ID'}\NormalTok{]).drop_duplicates([}\StringTok{'Sample'}\NormalTok{]).Sample}

\CommentTok{# the color order is specified here}
\CommentTok{# colors should be in the same order as the above sample_order Series, excluding samples with no data}
\NormalTok{colors }\OperatorTok{=}\NormalTok{ [pastel[}\StringTok{'Brown'}\NormalTok{], pastel[}\StringTok{'Blue'}\NormalTok{],}
\NormalTok{          pastel[}\StringTok{'Orange'}\NormalTok{], pastel[}\StringTok{'Purple'}\NormalTok{],}
\NormalTok{          pastel[}\StringTok{'Green'}\NormalTok{], pastel[}\StringTok{'Red'}\NormalTok{],}
\NormalTok{          ]}

\NormalTok{plt.figure()}
\CommentTok{# this is an example of plotting that uses the sample_order and palette to control coloration order}
\NormalTok{sns.catplot(x}\OperatorTok{=}\StringTok{'Sample'}\NormalTok{, y}\OperatorTok{=}\StringTok{'VAF'}\NormalTok{, hue}\OperatorTok{=}\StringTok{'Gene'}\NormalTok{, jitter}\OperatorTok{=}\VariableTok{True}\NormalTok{,}
\NormalTok{            data}\OperatorTok{=}\NormalTok{oncogenic[oncogenic.Location }\OperatorTok{==} \StringTok{'Peripheral'}\NormalTok{],}
\NormalTok{            legend}\OperatorTok{=}\VariableTok{False}\NormalTok{, order}\OperatorTok{=}\NormalTok{sample_order, palette}\OperatorTok{=}\NormalTok{sns.color_palette(colors))}

\CommentTok{# a colorscheme can be specified if desired}
\NormalTok{pastel }\OperatorTok{=}\NormalTok{ \{}\StringTok{'Blue'}\NormalTok{:}\StringTok{'#a3c6ff'}\NormalTok{, }\StringTok{'Orange'}\NormalTok{:}\StringTok{'#f7ab60'}\NormalTok{,}
          \StringTok{'Green'}\NormalTok{:}\StringTok{'#60f7a9'}\NormalTok{, }\StringTok{'Red'}\NormalTok{:}\StringTok{'#fc9d94'}\NormalTok{,}
          \StringTok{'Purple'}\NormalTok{:}\StringTok{'#bea3ff'}\NormalTok{, }\StringTok{'Brown'}\NormalTok{:}\StringTok{'#d1b485'}\NormalTok{,}
          \StringTok{'Pink'}\NormalTok{:}\StringTok{'#f7afdf'}\NormalTok{, }\StringTok{'Gray'}\NormalTok{:}\StringTok{'#c4c4c4'}\NormalTok{,}
          \StringTok{'Yellow'}\NormalTok{:}\StringTok{'#ffffaa'}\NormalTok{, }\StringTok{'LBlue'}\NormalTok{:}\StringTok{'#baf6ff'}\NormalTok{\}}

\CommentTok{# this controls the coloration in the legend}
\ImportTok{import}\NormalTok{ matplotlib.patches }\ImportTok{as}\NormalTok{ mpatches}
\NormalTok{egfr }\OperatorTok{=}\NormalTok{ mpatches.Patch(color}\OperatorTok{=}\NormalTok{pastel[}\StringTok{'Blue'}\NormalTok{], label}\OperatorTok{=}\StringTok{'EGFR'}\NormalTok{)}
\NormalTok{pik3ca }\OperatorTok{=}\NormalTok{ mpatches.Patch(color}\OperatorTok{=}\NormalTok{pastel[}\StringTok{'Orange'}\NormalTok{], label}\OperatorTok{=}\StringTok{'PIK3CA'}\NormalTok{)}
\NormalTok{myc }\OperatorTok{=}\NormalTok{ mpatches.Patch(color}\OperatorTok{=}\NormalTok{pastel[}\StringTok{'Green'}\NormalTok{], label}\OperatorTok{=}\StringTok{'MYC'}\NormalTok{)}

\NormalTok{plt.legend(handles}\OperatorTok{=}\NormalTok{[egfr,pik3ca,myc],}
\NormalTok{           loc}\OperatorTok{=}\StringTok{'upper right'}\NormalTok{, bbox_to_anchor}\OperatorTok{=}\NormalTok{(}\FloatTok{1.5}\NormalTok{, }\DecValTok{1}\NormalTok{),}
\NormalTok{           ncol}\OperatorTok{=}\DecValTok{1}\NormalTok{) }\CommentTok{# no legend overlap}
\end{Highlighting}
\end{Shaded}

\section{Matplotlib}\label{matplotlib}

Plotting a heatmap.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\NormalTok{a }\OperatorTok{=}\NormalTok{ np.random.random((}\DecValTok{16}\NormalTok{, }\DecValTok{16}\NormalTok{))}
\NormalTok{plt.imshow(a, cmap}\OperatorTok{=}\StringTok{'RdBu'', interpolation='}\NormalTok{nearest}\StringTok{')}
\StringTok{plt.show()}
\end{Highlighting}
\end{Shaded}

Possible heatmap colors are:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Accent, Accent_r, Blues, Blues_r, BrBG, BrBG_r, BuGn, BuGn_r, BuPu, BuPu_r, CMRmap, CMRmap_r, Dark2, Dark2_r, GnBu, GnBu_r, Greens, Greens_r, Greys, Greys_r, OrRd, OrRd_r, Oranges, Oranges_r, PRGn, PRGn_r, Paired, Paired_r, Pastel1, Pastel1_r, Pastel2, Pastel2_r, PiYG, PiYG_r, PuBu, PuBuGn, PuBuGn_r, PuBu_r, PuOr, PuOr_r, PuRd, PuRd_r, Purples, Purples_r, RdBu, RdBu_r, RdGy, RdGy_r, RdPu, RdPu_r, RdYlBu, RdYlBu_r, RdYlGn, RdYlGn_r, Reds, Reds_r, Set1,}
\NormalTok{Set1_r, Set2, Set2_r, Set3, Set3_r, Spectral, Spectral_r, Wistia, Wistia_r, YlGn, YlGnBu, YlGnBu_r, YlGn_r, YlOrBr, YlOrBr_r, YlOrRd, YlOrRd_r, afmhot, afmhot_r, autumn, autumn_r, binary, binary_r, bone, bone_r, brg, brg_r, bwr, bwr_r, cividis, cividis_r, cool, cool_r, coolwarm, coolwarm_r, copper, copper_r, cubehelix, cubehelix_r, flag, flag_r, gist_earth, gist_earth_r, gist_gray, gist_gray_r, gist_heat, gist_heat_r, gist_ncar, gist_ncar_r, gist_rainbow, gist_rainbow_r,}
\NormalTok{gist_stern, gist_stern_r, gist_yarg, gist_yarg_r, gnuplot, gnuplot2, gnuplot2_r, gnuplot_r, gray, gray_r, hot, hot_r, hsv, hsv_r, icefire, icefire_r, inferno, inferno_r, jet, jet_r, magma, magma_r, mako, mako_r, nipy_spectral, nipy_spectral_r, ocean, ocean_r, pink, pink_r, plasma, plasma_r, prism, prism_r, rainbow, rainbow_r, rocket, rocket_r, seismic, seismic_r, spring, spring_r, summer, summer_r, tab10, tab10_r, tab20, tab20_r, tab20b, tab20b_r, tab20c, tab20c_r, terrain, terrain_r,}
\NormalTok{twilight, twilight_r, twilight_shifted, twilight_shifted_r, viridis, viridis_r, vlag, vlag_r, winter, winter_r}
\end{Highlighting}
\end{Shaded}

A simple venn diagram.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ matplotlib_venn }\ImportTok{import}\NormalTok{ venn2}
\NormalTok{venn2(subsets }\OperatorTok{=}\NormalTok{ (}\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

A more complicated venn diagram.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ matplotlib }\ImportTok{import}\NormalTok{ pyplot }\ImportTok{as}\NormalTok{ plt}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{from}\NormalTok{ matplotlib_venn }\ImportTok{import}\NormalTok{ venn3, venn3_circles}
\NormalTok{plt.figure(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{4}\NormalTok{))}
\NormalTok{v }\OperatorTok{=}\NormalTok{ venn3(subsets}\OperatorTok{=}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{), set_labels }\OperatorTok{=}\NormalTok{ (}\StringTok{'A'}\NormalTok{, }\StringTok{'B'}\NormalTok{, }\StringTok{'C'}\NormalTok{))}
\NormalTok{v.get_patch_by_id(}\StringTok{'100'}\NormalTok{).set_alpha(}\FloatTok{1.0}\NormalTok{)}
\NormalTok{v.get_patch_by_id(}\StringTok{'100'}\NormalTok{).set_color(}\StringTok{'white'}\NormalTok{)}
\NormalTok{v.get_label_by_id(}\StringTok{'100'}\NormalTok{).set_text(}\StringTok{'Unknown'}\NormalTok{)}
\NormalTok{v.get_label_by_id(}\StringTok{'A'}\NormalTok{).set_text(}\StringTok{'Set "A"'}\NormalTok{)}
\NormalTok{c }\OperatorTok{=}\NormalTok{ venn3_circles(subsets}\OperatorTok{=}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{), linestyle}\OperatorTok{=}\StringTok{'dotted'}\NormalTok{)}
\NormalTok{c[}\DecValTok{0}\NormalTok{].set_lw(}\FloatTok{1.0}\NormalTok{)}
\NormalTok{c[}\DecValTok{0}\NormalTok{].set_ls(}\StringTok{'dotted'}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Sample Venn diagram"}\NormalTok{)}
\NormalTok{plt.annotate(}\StringTok{'Unknown set'}\NormalTok{, xy}\OperatorTok{=}\NormalTok{v.get_label_by_id(}\StringTok{'100'}\NormalTok{).get_position() }\OperatorTok{-}\NormalTok{ np.array([}\DecValTok{0}\NormalTok{, }\FloatTok{0.05}\NormalTok{]), xytext}\OperatorTok{=}\NormalTok{(}\OperatorTok{-}\DecValTok{70}\NormalTok{,}\OperatorTok{-}\DecValTok{70}\NormalTok{),}
\NormalTok{             ha}\OperatorTok{=}\StringTok{'center'}\NormalTok{, textcoords}\OperatorTok{=}\StringTok{'offset points'}\NormalTok{, bbox}\OperatorTok{=}\BuiltInTok{dict}\NormalTok{(boxstyle}\OperatorTok{=}\StringTok{'round,pad=0.5'}\NormalTok{, fc}\OperatorTok{=}\StringTok{'gray'}\NormalTok{, alpha}\OperatorTok{=}\FloatTok{0.1}\NormalTok{),}
\NormalTok{                          arrowprops}\OperatorTok{=}\BuiltInTok{dict}\NormalTok{(arrowstyle}\OperatorTok{=}\StringTok{'->'}\NormalTok{, connectionstyle}\OperatorTok{=}\StringTok{'arc3,rad=0.5'}\NormalTok{,color}\OperatorTok{=}\StringTok{'gray'}\NormalTok{))}
\NormalTok{                          plt.show()}
\end{Highlighting}
\end{Shaded}

An upset plot is a nice alternative to a traditional venn diagram. The
project is hosted \href{https://pypi.org/project/UpSetPlot/}{here}, and
\href{https://buildmedia.readthedocs.org/media/pdf/upsetplot/latest/upsetplot.pdf}{this}
is the documentation.

First install the library.

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{pip}\NormalTok{ install upsetplot}
\end{Highlighting}
\end{Shaded}

Here is the code to create the plot.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\NormalTok{arrays }\OperatorTok{=}\NormalTok{ [[}\VariableTok{False}\NormalTok{,}\VariableTok{False}\NormalTok{,}\VariableTok{False}\NormalTok{,}\VariableTok{False}\NormalTok{,}\VariableTok{True}\NormalTok{,}\VariableTok{True}\NormalTok{,}\VariableTok{True}\NormalTok{,}\VariableTok{True}\NormalTok{],}
\NormalTok{          [}\VariableTok{False}\NormalTok{,}\VariableTok{False}\NormalTok{,}\VariableTok{True}\NormalTok{,}\VariableTok{True}\NormalTok{,}\VariableTok{False}\NormalTok{,}\VariableTok{False}\NormalTok{,}\VariableTok{True}\NormalTok{,}\VariableTok{True}\NormalTok{],}
\NormalTok{          [}\VariableTok{False}\NormalTok{,}\VariableTok{True}\NormalTok{,}\VariableTok{False}\NormalTok{,}\VariableTok{True}\NormalTok{,}\VariableTok{False}\NormalTok{,}\VariableTok{True}\NormalTok{,}\VariableTok{False}\NormalTok{,}\VariableTok{True}\NormalTok{]]}
\NormalTok{tuples }\OperatorTok{=} \BuiltInTok{list}\NormalTok{(}\BuiltInTok{zip}\NormalTok{(}\OperatorTok{*}\NormalTok{arrays))}

\KeywordTok{def}\NormalTok{ o(one}\OperatorTok{=}\VariableTok{False}\NormalTok{, two}\OperatorTok{=}\VariableTok{False}\NormalTok{, three}\OperatorTok{=}\VariableTok{False}\NormalTok{):}
    \ControlFlowTok{if}\NormalTok{ three:}
\NormalTok{        temp }\OperatorTok{=}\NormalTok{ pd.merge(indels[(indels.Individual}\OperatorTok{==}\NormalTok{one)], indels[(indels.Individual}\OperatorTok{==}\NormalTok{two)], how}\OperatorTok{=}\StringTok{'inner'}\NormalTok{, on}\OperatorTok{=}\NormalTok{[}\StringTok{'Loc'}\NormalTok{, }\StringTok{'Var'}\NormalTok{])}
        \ControlFlowTok{return} \BuiltInTok{len}\NormalTok{(pd.merge(temp, indels[(indels.Individual}\OperatorTok{==}\NormalTok{three)], how}\OperatorTok{=}\StringTok{'inner'}\NormalTok{, on}\OperatorTok{=}\NormalTok{[}\StringTok{'Loc'}\NormalTok{, }\StringTok{'Var'}\NormalTok{]))}
    \ControlFlowTok{elif}\NormalTok{ two:}
        \ControlFlowTok{return} \BuiltInTok{len}\NormalTok{(pd.merge(indels[(indels.Individual}\OperatorTok{==}\NormalTok{one)], indels[(indels.Individual}\OperatorTok{==}\NormalTok{two)], how}\OperatorTok{=}\StringTok{'inner'}\NormalTok{, on}\OperatorTok{=}\NormalTok{[}\StringTok{'Loc'}\NormalTok{, }\StringTok{'Var'}\NormalTok{]))}
    \ControlFlowTok{elif}\NormalTok{ one:}
        \ControlFlowTok{return} \BuiltInTok{len}\NormalTok{(indels[(indels.Individual}\OperatorTok{==}\NormalTok{one)])}
    \ControlFlowTok{else}\NormalTok{:}
        \ControlFlowTok{return} \DecValTok{0}

\NormalTok{index }\OperatorTok{=}\NormalTok{ pd.MultiIndex.from_tuples(tuples, names}\OperatorTok{=}\NormalTok{[}\StringTok{'Ind 1'}\NormalTok{, }\StringTok{'Ind 2'}\NormalTok{, }\StringTok{'Ind 3'}\NormalTok{])}
\NormalTok{s }\OperatorTok{=}\NormalTok{ pd.Series([o(),}
\NormalTok{               o(}\DecValTok{3}\NormalTok{),}
\NormalTok{               o(}\DecValTok{2}\NormalTok{),}
\NormalTok{               o(}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{),}
\NormalTok{               o(}\DecValTok{1}\NormalTok{),}
\NormalTok{               o(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{),}
\NormalTok{               o(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{),}
\NormalTok{               o(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{)], index}\OperatorTok{=}\NormalTok{index)}

\ImportTok{from}\NormalTok{ upsetplot }\ImportTok{import}\NormalTok{ plot }\ImportTok{as}\NormalTok{ up}
\NormalTok{up(s)}
\NormalTok{plt.savefig(}\StringTok{"../images/indels.svg"}\NormalTok{, }\BuiltInTok{format}\OperatorTok{=}\StringTok{"svg"}\NormalTok{, bbox_inches}\OperatorTok{=}\StringTok{"tight"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Log scales seem to always be a challenge. Here is at least one solution
to change ticks to log manually.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y_major_ticks }\OperatorTok{=}\NormalTok{ [np.log(}\DecValTok{100}\NormalTok{),np.log(}\DecValTok{200}\NormalTok{),np.log(}\DecValTok{300}\NormalTok{),np.log(}\DecValTok{400}\NormalTok{),np.log(}\DecValTok{500}\NormalTok{),np.log(}\DecValTok{600}\NormalTok{),np.log(}\DecValTok{700}\NormalTok{),np.log(}\DecValTok{800}\NormalTok{),np.log(}\DecValTok{900}\NormalTok{),}\OperatorTok{\textbackslash{}}
\NormalTok{                 np.log(}\DecValTok{1000}\NormalTok{),np.log(}\DecValTok{2000}\NormalTok{),np.log(}\DecValTok{3000}\NormalTok{),np.log(}\DecValTok{4000}\NormalTok{),np.log(}\DecValTok{5000}\NormalTok{),np.log(}\DecValTok{6000}\NormalTok{),np.log(}\DecValTok{7000}\NormalTok{),np.log(}\DecValTok{8000}\NormalTok{),np.log(}\DecValTok{9000}\NormalTok{),}\OperatorTok{\textbackslash{}}
\NormalTok{                 np.log(}\DecValTok{10000}\NormalTok{),np.log(}\DecValTok{20000}\NormalTok{),np.log(}\DecValTok{30000}\NormalTok{),np.log(}\DecValTok{40000}\NormalTok{),np.log(}\DecValTok{50000}\NormalTok{),np.log(}\DecValTok{60000}\NormalTok{),np.log(}\DecValTok{70000}\NormalTok{),np.log(}\DecValTok{80000}\NormalTok{),np.log(}\DecValTok{90000}\NormalTok{),}\OperatorTok{\textbackslash{}}
\NormalTok{                 np.log(}\DecValTok{100000}\NormalTok{),np.log(}\DecValTok{200000}\NormalTok{),np.log(}\DecValTok{300000}\NormalTok{),np.log(}\DecValTok{400000}\NormalTok{),np.log(}\DecValTok{500000}\NormalTok{),np.log(}\DecValTok{600000}\NormalTok{),np.log(}\DecValTok{700000}\NormalTok{),np.log(}\DecValTok{800000}\NormalTok{),np.log(}\DecValTok{900000}\NormalTok{),}\OperatorTok{\textbackslash{}}
\NormalTok{                 np.log(}\DecValTok{1000000}\NormalTok{),np.log(}\DecValTok{2000000}\NormalTok{),np.log(}\DecValTok{3000000}\NormalTok{),np.log(}\DecValTok{4000000}\NormalTok{),np.log(}\DecValTok{5000000}\NormalTok{),np.log(}\DecValTok{6000000}\NormalTok{),np.log(}\DecValTok{7000000}\NormalTok{),np.log(}\DecValTok{8000000}\NormalTok{),np.log(}\DecValTok{9000000}\NormalTok{),}\OperatorTok{\textbackslash{}}
\NormalTok{                 np.log(}\DecValTok{10000000}\NormalTok{)]}

\NormalTok{y_major_tick_labels }\OperatorTok{=}\NormalTok{ [}\StringTok{"100"}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{, }\StringTok{"1000"}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{, }\StringTok{"10,000"}\NormalTok{,}\OperatorTok{\textbackslash{}}
                       \StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{"100,000"}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{, }\StringTok{"1,000,000"}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{,}\StringTok{""}\NormalTok{, }\StringTok{"10,000,000"}\NormalTok{ ]}
\NormalTok{ax1.set_yticks(y_major_ticks)}
\NormalTok{ax1.set_yticklabels(y_major_tick_labels, fontsize }\OperatorTok{=}\NormalTok{ axisfont)}
\NormalTok{ax1.yaxis.set_tick_params(width}\OperatorTok{=}\NormalTok{scale, color }\OperatorTok{=}\NormalTok{ grey3, length }\OperatorTok{=} \DecValTok{6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{Seaborn}\label{seaborn}

Here is a general bar plot that includes some commonly used parameters.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# fits my 22 inch monitor}
\NormalTok{plt.figure(figsize}\OperatorTok{=}\NormalTok{(}\FloatTok{19.17}\NormalTok{,}\FloatTok{11.98}\NormalTok{))}
\CommentTok{# order controls the display order of the samples}
\NormalTok{sns.catplot(x}\OperatorTok{=}\StringTok{"Sample"}\NormalTok{, y}\OperatorTok{=}\StringTok{"Somatic"}\NormalTok{, kind}\OperatorTok{=}\StringTok{"bar"}\NormalTok{, data}\OperatorTok{=}\NormalTok{var_counts, order}\OperatorTok{=}\NormalTok{labels)}\OperatorTok{;}
\CommentTok{# keeps x-axis labels, but eliminates the tick mark}
\NormalTok{plt.tick_params(labelbottom}\OperatorTok{=}\VariableTok{True}\NormalTok{, bottom}\OperatorTok{=}\VariableTok{False}\NormalTok{)}
\CommentTok{# trim off the x-axis}
\NormalTok{sns.despine(offset}\OperatorTok{=}\DecValTok{10}\NormalTok{, trim}\OperatorTok{=}\VariableTok{True}\NormalTok{, bottom}\OperatorTok{=}\VariableTok{True}\NormalTok{)}
\CommentTok{# labels}
\NormalTok{plt.title(}\StringTok{''}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{''}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{8}\NormalTok{)}
\NormalTok{plt.xlabel(}\StringTok{''}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{8}\NormalTok{)}
\CommentTok{# manual control of xlabels}
\NormalTok{labels }\OperatorTok{=}\NormalTok{ [}\StringTok{'Indiv_1-a'}\NormalTok{,}\StringTok{'Indiv_2'}\NormalTok{,}\StringTok{'Indiv_3'}\NormalTok{,}\StringTok{'Indiv_1-b'}\NormalTok{]}
\CommentTok{# control xtick order}
\NormalTok{plt.xticks(}\BuiltInTok{range}\NormalTok{(}\BuiltInTok{len}\NormalTok{(labels)), labels, rotation}\OperatorTok{=}\DecValTok{45}\NormalTok{)}
\CommentTok{# control the number of x-ticks}
\NormalTok{plt.locator_params(axis}\OperatorTok{=}\StringTok{'x'}\NormalTok{, nbins}\OperatorTok{=}\DecValTok{10}\NormalTok{)}
\CommentTok{# legend positioning}
\NormalTok{plt.legend(loc}\OperatorTok{=}\StringTok{'upper right'}\NormalTok{)}
\CommentTok{# log scale}
\NormalTok{plt.gca().set_yscale(}\StringTok{'log'}\NormalTok{)}
\CommentTok{# this is better if neg values are needed}
\NormalTok{plt.gca().set_yscale(}\StringTok{'symlog'}\NormalTok{)}
\CommentTok{# fit plot to display}
\NormalTok{plt.tight_layout()}
\NormalTok{plt.show()}
\CommentTok{# save figure with tight_layout}
\NormalTok{plt.savefig(}\StringTok{"test.svg"}\NormalTok{, }\BuiltInTok{format}\OperatorTok{=}\StringTok{"svg"}\NormalTok{, bbox_inches}\OperatorTok{=}\StringTok{"tight"}\NormalTok{, dpi}\OperatorTok{=}\DecValTok{1000}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Signifance information can be added by including p-values and label bars
using the following code.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x1, x2 }\OperatorTok{=} \DecValTok{0}\NormalTok{, }\DecValTok{1} \CommentTok{# columns to annotate on the plot}
\NormalTok{y2, y1 }\OperatorTok{=} \DecValTok{20}\NormalTok{, }\DecValTok{15} \CommentTok{# placement of the line and how for down the vertical legs go}
\NormalTok{plt.plot([x1,x1, x2, x2], [y1, y2, y2, y1], linewidth}\OperatorTok{=}\DecValTok{1}\NormalTok{, color}\OperatorTok{=}\StringTok{'k'}\NormalTok{) }\CommentTok{# stats line}
\NormalTok{plt.text((x1}\OperatorTok{+}\NormalTok{x2)}\OperatorTok{*}\NormalTok{.}\DecValTok{5}\NormalTok{, y2}\OperatorTok{+}\DecValTok{2}\NormalTok{, }\StringTok{"p=0.09"}\NormalTok{, ha}\OperatorTok{=}\StringTok{'center'}\NormalTok{, va}\OperatorTok{=}\StringTok{'bottom'}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{8}\NormalTok{) }\CommentTok{# p-value or sig}
\end{Highlighting}
\end{Shaded}

\section{Statistics}\label{statistics}

This is a two-sided T-test for the null hypothesis that two populations
have the same means. It is important to note that it assumes the
population variances are the same, so this must be changed if the
assumption is incorrect.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# ttest_ind(a, b, axis=0, equal_var=True, nan_policy='propagate')}
\ImportTok{from}\NormalTok{ scipy.stats }\ImportTok{import}\NormalTok{ ttest_ind}
\NormalTok{ttest_ind(df[df[}\StringTok{'sample'}\NormalTok{] }\OperatorTok{==} \StringTok{'one'}\NormalTok{][}\StringTok{'means'}\NormalTok{], df[df[}\StringTok{'sample'}\NormalTok{] }\OperatorTok{==} \StringTok{'two'}\NormalTok{][}\StringTok{'means'}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\section{Various Plot Styles}\label{various-plot-styles}

This displays each individual datapoint overlayed on a boxplot

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ax }\OperatorTok{=}\NormalTok{ sns.boxplot(x}\OperatorTok{=}\StringTok{'day'}\NormalTok{, y}\OperatorTok{=}\StringTok{'total_bill'}\NormalTok{, data}\OperatorTok{=}\NormalTok{tips)}
\NormalTok{ax }\OperatorTok{=}\NormalTok{ sns.swarmplot(x}\OperatorTok{=}\StringTok{'day'}\NormalTok{, y}\OperatorTok{=}\StringTok{'total_bill'}\NormalTok{, data}\OperatorTok{=}\NormalTok{tips, color}\OperatorTok{=}\StringTok{'.25'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\chapter{Biology}\label{biology}

\section{General}\label{general-1}

Some helpful commands for genetic sequence.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ string }\ImportTok{import}\NormalTok{ ascii_uppercase }\CommentTok{# python 3}
\ImportTok{from}\NormalTok{ string }\ImportTok{import}\NormalTok{ upper, lower }\CommentTok{# python 2}
\NormalTok{upper(}\StringTok{'tcga'}\NormalTok{)}
\NormalTok{lower(}\StringTok{'TCGA'}\NormalTok{)}
\NormalTok{title(}\StringTok{'tcga'}\NormalTok{) }\CommentTok{# capitalize the first letter}
\end{Highlighting}
\end{Shaded}

\section{Biopython}\label{biopython}

Reverse complement of sequence

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ Bio.Seq }\ImportTok{import}\NormalTok{ Seq}
\BuiltInTok{str}\NormalTok{(Seq(i).reverse_complement())}
\end{Highlighting}
\end{Shaded}

\section{UCSC Genome Browser}\label{ucsc-genome-browser}

Get sequence from UCSC genome browser

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ subprocess }\ImportTok{import}\NormalTok{ check_output, STDOUT}
\NormalTok{temp }\OperatorTok{=}\NormalTok{ check_output(}\StringTok{'wget -qO- http://genome.ucsc.edu/cgi-bin/das/hg19/dna?segment=}\SpecialCharTok{%s}\StringTok{:}\SpecialCharTok{%s}\StringTok{,}\SpecialCharTok{%s}\StringTok{'} \OperatorTok{%}\NormalTok{ (vcfObj.chrom,low,high), stderr}\OperatorTok{=}\NormalTok{STDOUT, shell}\OperatorTok{=}\VariableTok{True}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{Ref Genome}\label{ref-genome}

Get sequence from reference genome

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ subprocess }\ImportTok{import}\NormalTok{ check_output, STDOUT}
\NormalTok{temp }\OperatorTok{=}\NormalTok{ check_output(}\StringTok{'samtools faidx }\SpecialCharTok{%s}\StringTok{ }\SpecialCharTok{%s}\StringTok{:}\SpecialCharTok{%s}\StringTok{-}\SpecialCharTok{%s}\StringTok{'} \OperatorTok{%}\NormalTok{ (ref, vcfObj.chrom, low, high), stderr}\OperatorTok{=}\NormalTok{STDOUT, shell}\OperatorTok{=}\VariableTok{True}\NormalTok{)}

\NormalTok{finalSeq }\OperatorTok{=} \StringTok{''}
\ControlFlowTok{for}\NormalTok{ line }\KeywordTok{in}\NormalTok{ temp.decode(}\StringTok{'UTF-8'}\NormalTok{).split(}\StringTok{'}\CharTok{\textbackslash{}n}\StringTok{'}\NormalTok{):}
\ControlFlowTok{for}\NormalTok{ line }\KeywordTok{in}\NormalTok{ temp.decode(}\StringTok{'UTF-8'}\NormalTok{).split(}\StringTok{'}\CharTok{\textbackslash{}n}\StringTok{'}\NormalTok{): }\CommentTok{# this is only necessary in python 3 to convert binary to string}
    \ControlFlowTok{if} \StringTok{'>'} \KeywordTok{not} \KeywordTok{in}\NormalTok{ line:}
\NormalTok{        finalSeq }\OperatorTok{+=}\NormalTok{ line}

\NormalTok{finalSeq }\OperatorTok{=}\NormalTok{ finalSeq.upper()}
\end{Highlighting}
\end{Shaded}

\section{Personal Information}\label{personal-information}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# parse vcf file with parseline}
\ControlFlowTok{if} \StringTok{'#'} \KeywordTok{not} \KeywordTok{in}\NormalTok{ line }\KeywordTok{and} \StringTok{'chr'} \KeywordTok{in}\NormalTok{ line: }\CommentTok{# skip the info}
\CommentTok{# vcf handling}
\ImportTok{from}\NormalTok{ parseline }\ImportTok{import}\NormalTok{ VCFObj}
\CommentTok{# or}
\ImportTok{from}\NormalTok{ util }\ImportTok{import}\NormalTok{ VCFObj}
\NormalTok{vcfObj }\OperatorTok{=}\NormalTok{ VCFObj(vcfLine)}
\CommentTok{# available attributes: ao, dp, af, wt, var, chrom, location}
\end{Highlighting}
\end{Shaded}

\chapter{Data I/O}\label{io}

\section{Reading Data Files}\label{reading-data-files}

Opening .gz files

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ gzip}
\ControlFlowTok{for}\NormalTok{ line }\KeywordTok{in}\NormalTok{ gzip.}\BuiltInTok{open}\NormalTok{(}\StringTok{'myFile.gz'}\NormalTok{):}
    \BuiltInTok{print}\NormalTok{ line}
\end{Highlighting}
\end{Shaded}

\section{Pickles}\label{pickles}

Writing data in pickle format

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ pickle}
\NormalTok{p }\OperatorTok{=} \BuiltInTok{open}\NormalTok{(}\StringTok{'principle.pkl'}\NormalTok{, }\StringTok{'wb'}\NormalTok{)}
\NormalTok{pickle.dump(principleData, p)}
\NormalTok{p.close()}
\end{Highlighting}
\end{Shaded}

Reading data in pickle format

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ pickle}
\NormalTok{p }\OperatorTok{=} \BuiltInTok{open}\NormalTok{(}\StringTok{'principle.pkl'}\NormalTok{, }\StringTok{'rb'}\NormalTok{)}
\NormalTok{principleData }\OperatorTok{=}\NormalTok{ pickle.load(p)}
\NormalTok{p.close()}
\end{Highlighting}
\end{Shaded}

\chapter{Pandas}\label{pandas}

\section{File I/O}\label{file-io}

Read a csv file into a DataFrame.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pd.read_csv(filepath)}
\end{Highlighting}
\end{Shaded}

Write a DataFrame to a file.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x.to_csv(path_or_buf}\OperatorTok{=}\StringTok{'outputDir'}\NormalTok{, sep}\OperatorTok{=}\StringTok{'}\CharTok{\textbackslash{}n}\StringTok{'}\NormalTok{, header}\OperatorTok{=}\VariableTok{False}\NormalTok{, index}\OperatorTok{=}\VariableTok{False}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{Data Structure Creation}\label{data-structure-creation}

Create a DataFrame.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{frame }\OperatorTok{=}\NormalTok{ pd.DataFrame(np.random.randn(}\DecValTok{4}\NormalTok{,}\DecValTok{3}\NormalTok{), columns}\OperatorTok{=}\BuiltInTok{list}\NormalTok{(}\StringTok{'bde'}\NormalTok{), index}\OperatorTok{=}\NormalTok{[}\StringTok{'Utah'}\NormalTok{,}\StringTok{'Ohio'}\NormalTok{,}\StringTok{'Texas'}\NormalTok{,}\StringTok{'Oregon'}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

A DataFrame can conveniently be created from a dictionary.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}
\NormalTok{data }\OperatorTok{=}\NormalTok{ \{}\StringTok{'AAA'}\NormalTok{ : [}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{], }\StringTok{'BBB'}\NormalTok{ : [}\DecValTok{10}\NormalTok{,}\DecValTok{20}\NormalTok{,}\DecValTok{30}\NormalTok{,}\DecValTok{40}\NormalTok{],}\StringTok{'CCC'}\NormalTok{ : [}\DecValTok{100}\NormalTok{,}\DecValTok{50}\NormalTok{,}\OperatorTok{-}\DecValTok{30}\NormalTok{,}\OperatorTok{-}\DecValTok{50}\NormalTok{]\}}
\NormalTok{df2 }\OperatorTok{=}\NormalTok{ pd.DataFrame(data}\OperatorTok{=}\NormalTok{data,index}\OperatorTok{=}\NormalTok{[}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{]) }\CommentTok{#Note index starts at 1.}
\NormalTok{df2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    AAA  BBB  CCC
## 1    4   10  100
## 2    5   20   50
## 3    6   30  -30
## 4    7   40  -50
\end{verbatim}

\section{Selection}\label{selection}

Is data within a DataFrame found within a dictionary or list? (Instead
of a dictionary a series can be used and maybe another DataFrame)

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}
\NormalTok{df }\OperatorTok{=}\NormalTok{ pd.DataFrame(\{}\StringTok{'A'}\NormalTok{: [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{], }\StringTok{'B'}\NormalTok{: [}\StringTok{'a'}\NormalTok{, }\StringTok{'b'}\NormalTok{, }\StringTok{'f'}\NormalTok{]\})}
\NormalTok{df.isin([}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{12}\NormalTok{, }\StringTok{'a'}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        A      B
## 0   True   True
## 1  False  False
## 2   True  False
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[df.isin([}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{12}\NormalTok{, }\StringTok{'a'}\NormalTok{])]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      A    B
## 0  1.0    a
## 1  NaN  NaN
## 2  3.0  NaN
\end{verbatim}

Data within a DataFrame can be selected based on position within the
DataFrame.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}
\NormalTok{df2.iloc[}\DecValTok{1}\NormalTok{:}\DecValTok{3}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    AAA  BBB  CCC
## 2    5   20   50
## 3    6   30  -30
\end{verbatim}

Data within a DataFrame can be selected based on position within the
DataFrame.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}
\NormalTok{df2.loc[}\DecValTok{1}\NormalTok{:}\DecValTok{3}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    AAA  BBB  CCC
## 1    4   10  100
## 2    5   20   50
## 3    6   30  -30
\end{verbatim}

The opposite of matching data can be selected with the inverse operator.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[}\OperatorTok{~}\NormalTok{((df.AAA }\OperatorTok{<=} \DecValTok{6}\NormalTok{) }\OperatorTok{&}\NormalTok{ (df.index.isin([}\DecValTok{0}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{])))]}
\end{Highlighting}
\end{Shaded}

\section{Splitting}\label{splitting}

Concatenate two DataFrames together without dropping any values or
renaming indices.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{left }\OperatorTok{=}\NormalTok{ pd.concat([left,left])}
\end{Highlighting}
\end{Shaded}

Concatenate two DataFrames together without dropping values, but
renaming index.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{left }\OperatorTok{=}\NormalTok{ pd.concat([left,left], ignore_index}\OperatorTok{=}\VariableTok{True}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Count the number of each unique value in a specified column.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{left[}\StringTok{'key1'}\NormalTok{].value_counts()}
\NormalTok{left.key1.value_counts()}
\end{Highlighting}
\end{Shaded}

Value counts can also be calculated as percentages so that raw counts as
percent makeup can be compared.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{left[}\StringTok{'key1'}\NormalTok{].value_counts(normalize}\OperatorTok{=}\VariableTok{True}\NormalTok{) }\OperatorTok{*} \DecValTok{100}
\end{Highlighting}
\end{Shaded}

Two DataFrames can be merged such that only the data containing matching
keys is retained.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{result }\OperatorTok{=}\NormalTok{ pd.merge(left, right, how}\OperatorTok{=}\StringTok{'inner'}\NormalTok{, on}\OperatorTok{=}\NormalTok{[}\StringTok{'key1'}\NormalTok{, }\StringTok{'key2'}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

This DataFrame merge will retain all of the data in the right DataFrame.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{result }\OperatorTok{=}\NormalTok{ pd.merge(left, right, how}\OperatorTok{=}\StringTok{'right'}\NormalTok{, on}\OperatorTok{=}\NormalTok{[}\StringTok{'key1'}\NormalTok{, }\StringTok{'key2'}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

Filter by multiple columns.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[(df.one }\OperatorTok{==} \DecValTok{1}\NormalTok{) }\OperatorTok{&}\NormalTok{ (df.two }\OperatorTok{==} \DecValTok{2}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

Filter by multiple columns but only return certain values.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# this just returns the data in column AAA}
\NormalTok{df }\OperatorTok{=}\NormalTok{ pd.DataFrame(\{}\StringTok{'AAA'}\NormalTok{ : [}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{], }\StringTok{'BBB'}\NormalTok{ : [}\DecValTok{10}\NormalTok{,}\DecValTok{20}\NormalTok{,}\DecValTok{30}\NormalTok{,}\DecValTok{40}\NormalTok{],}\StringTok{'CCC'}\NormalTok{ : [}\DecValTok{100}\NormalTok{,}\DecValTok{50}\NormalTok{,}\OperatorTok{-}\DecValTok{30}\NormalTok{,}\OperatorTok{-}\DecValTok{50}\NormalTok{]\})}
\NormalTok{newseries }\OperatorTok{=}\NormalTok{ df.loc[(df[}\StringTok{'BBB'}\NormalTok{] }\OperatorTok{<} \DecValTok{25}\NormalTok{) }\OperatorTok{&}\NormalTok{ (df[}\StringTok{'CCC'}\NormalTok{] }\OperatorTok{>=} \OperatorTok{-}\DecValTok{40}\NormalTok{), }\StringTok{'AAA'}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

Filtering by values and using assignment will modify the original
DataFrame.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df.loc[(df[}\StringTok{'BBB'}\NormalTok{] }\OperatorTok{>} \DecValTok{25}\NormalTok{) }\OperatorTok{|}\NormalTok{ (df[}\StringTok{'CCC'}\NormalTok{] }\OperatorTok{>=} \DecValTok{75}\NormalTok{), }\StringTok{'AAA'}\NormalTok{] }\OperatorTok{=} \FloatTok{0.1}
\end{Highlighting}
\end{Shaded}

Select multiple values from a particular column, where Letter is the
column header.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[df.Letter.isin([}\StringTok{'a'}\NormalTok{,}\StringTok{'b'}\NormalTok{])]}
\end{Highlighting}
\end{Shaded}

Use itertools to find combinations of data within a column of two
DataFrames.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{itertools.product(df1[}\StringTok{'a'}\NormalTok{], df2[}\StringTok{'a'}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

Add data to a particular cell within a DataFrame.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df.loc[index,column]}\OperatorTok{=}\NormalTok{num}
\end{Highlighting}
\end{Shaded}

Make a copy of a DataFrame.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df.copy(deep}\OperatorTok{=}\VariableTok{True}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Iterate through a DataFrame.

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in}\NormalTok{ df.itertuples():}
    \ControlFlowTok{pass}
\end{Highlighting}
\end{Shaded}

Change order of columns.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OperatorTok{=}\NormalTok{ x.reindex(columns}\OperatorTok{=}\NormalTok{[}\StringTok{'header'}\NormalTok{,}\StringTok{'seq'}\NormalTok{,}\StringTok{'plus'}\NormalTok{,}\StringTok{'qual'}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

Make a DataFrame from a dictionary

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d }\OperatorTok{=}\NormalTok{ \{}\StringTok{'col1'}\NormalTok{: [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{], }\StringTok{'col2'}\NormalTok{: [}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{]\}}
\NormalTok{x }\OperatorTok{=}\NormalTok{ pd.DataFrame(d)}
\end{Highlighting}
\end{Shaded}

Sample from a DataFrame.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df.sample(frac}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
\NormalTok{df.sample(n}\OperatorTok{=}\DecValTok{20}\NormalTok{, axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Append to a DataFrame.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}\OperatorTok{=}\NormalTok{df.append(newdf, ignore_index}\OperatorTok{=}\VariableTok{True}\NormalTok{) }\CommentTok{# without ignore_index, the original indices will be used}
\end{Highlighting}
\end{Shaded}

Remove duplicates

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OperatorTok{=}\NormalTok{ x[}\OperatorTok{~}\NormalTok{x.index.duplicated(keep}\OperatorTok{=}\StringTok{'first'}\NormalTok{)] }\CommentTok{# most ideal method}

\NormalTok{data }\OperatorTok{=}\NormalTok{ pd.DataFrame(\{}\StringTok{'k1'}\NormalTok{:[}\StringTok{'one'}\NormalTok{,}\StringTok{'two'}\NormalTok{]}\OperatorTok{*}\DecValTok{3}\OperatorTok{+}\NormalTok{[}\StringTok{'two'}\NormalTok{],}\StringTok{'k2'}\NormalTok{:[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{4}\NormalTok{]\})}
\NormalTok{data.duplicated() }\CommentTok{# identify duplicate data}
\NormalTok{data[k1].duplicated()}
\NormalTok{data[}\StringTok{'k1'}\NormalTok{].drop_duplicates()}
\NormalTok{data.drop_duplicates[}\StringTok{'k1'}\NormalTok{] }\CommentTok{# this does the same thing as the previous line}
\NormalTok{data.drop_duplicates([}\StringTok{'k1'}\NormalTok{,}\StringTok{'k2'}\NormalTok{], keep}\OperatorTok{=}\StringTok{'last'}\NormalTok{) }\CommentTok{# drops unique found in k1 and k2 and keeps the last indexed duplicate}
\end{Highlighting}
\end{Shaded}

Check if string is within strings in a given column

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[x[}\StringTok{'strLoc'}\NormalTok{].}\BuiltInTok{str}\NormalTok{.contains(region)]}
\end{Highlighting}
\end{Shaded}

\section{Relabeling}\label{relabeling}

Rename a column or group of columns can be done by passing a dictionary
of the changes.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{    df }\OperatorTok{=}\NormalTok{ df.rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{'a'}\NormalTok{:}\StringTok{'b'}\NormalTok{,}\StringTok{'c'}\NormalTok{:}\StringTok{'d'}\NormalTok{\})}
\end{Highlighting}
\end{Shaded}

\section{Sorting and Arranging}\label{sorting-and-arranging}

The data in a DataFrame can be sorted in numeric or lexicographic order.
The following code sorts the values within the columns a and b.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df.sort_values([}\StringTok{'a'}\NormalTok{,}\StringTok{'b'}\NormalTok{], ascending}\OperatorTok{=}\VariableTok{False}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Set a column as the new index

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x.set_index([}\StringTok{'uniques'}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\section{Editing Data}\label{editing-data}

Drop columns from a DataFrame.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\NormalTok{df }\OperatorTok{=}\NormalTok{ pd.DataFrame(np.arange(}\DecValTok{12}\NormalTok{).reshape(}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{),}
\NormalTok{                    columns}\OperatorTok{=}\NormalTok{[}\StringTok{'A'}\NormalTok{, }\StringTok{'B'}\NormalTok{, }\StringTok{'C'}\NormalTok{, }\StringTok{'D'}\NormalTok{])}
\BuiltInTok{print}\NormalTok{(df)}

\NormalTok{df }\OperatorTok{=}\NormalTok{ df.drop(columns}\OperatorTok{=}\NormalTok{[}\StringTok{'B'}\NormalTok{, }\StringTok{'C'}\NormalTok{]) }\CommentTok{# may not work in python 2}
\NormalTok{df }\OperatorTok{=}\NormalTok{ df.drop([}\StringTok{'B'}\NormalTok{, }\StringTok{'C'}\NormalTok{], axis}\OperatorTok{=}\DecValTok{1}\NormalTok{) }\CommentTok{# this works in python 2}
\BuiltInTok{print}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

Changing the datatype of a column of data can be done by just changing
column type.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df.Age }\OperatorTok{=}\NormalTok{ df.Age.astype(}\BuiltInTok{str}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Replace values.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data }\OperatorTok{=}\NormalTok{ pd.Series([}\DecValTok{1}\NormalTok{., }\OperatorTok{-}\DecValTok{999}\NormalTok{., }\DecValTok{2}\NormalTok{., }\OperatorTok{-}\DecValTok{999}\NormalTok{., }\OperatorTok{-}\DecValTok{1000}\NormalTok{., }\DecValTok{3}\NormalTok{.])}
\NormalTok{data.replace(}\OperatorTok{-}\DecValTok{999}\NormalTok{, np.nan)}
\end{Highlighting}
\end{Shaded}

\subsection{Replace values}\label{replace-values}

New data can be set within a DataFrame one subset at a time in a way
that will avoid the SettingWithCopyWarning.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}
\NormalTok{df }\OperatorTok{=}\NormalTok{ pd.DataFrame(\{}\StringTok{'Trait'}\NormalTok{:[}\StringTok{'Seed_Shape'}\NormalTok{,}\StringTok{'Seed_Shape'}\NormalTok{,}\StringTok{'Flower_Color'}\NormalTok{,}\StringTok{'Flower_Color'}\NormalTok{],}
                    \StringTok{'Phenotype'}\NormalTok{:[}\StringTok{'Round'}\NormalTok{,}\StringTok{'Wrinkled'}\NormalTok{,}\StringTok{'Purple'}\NormalTok{,}\StringTok{'White'}\NormalTok{]\})}
\NormalTok{df.loc[df.Trait }\OperatorTok{==} \StringTok{'Seed_Shape'}\NormalTok{, }\StringTok{'Affected_Part'}\NormalTok{] }\OperatorTok{=} \StringTok{'Seed'}
\NormalTok{df.loc[df.Trait }\OperatorTok{==} \StringTok{'Flower_Color'}\NormalTok{, }\StringTok{'Affected_Part'}\NormalTok{] }\OperatorTok{=} \StringTok{'Flower'}
\BuiltInTok{print}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           Trait Phenotype Affected_Part
## 0    Seed_Shape     Round          Seed
## 1    Seed_Shape  Wrinkled          Seed
## 2  Flower_Color    Purple        Flower
## 3  Flower_Color     White        Flower
\end{verbatim}

There is a more simple alternative to the above method buit it may
result in the SettingWithCopyWarning.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OperatorTok{=}\NormalTok{ df.replace(}\StringTok{'pork'}\NormalTok{,}\StringTok{'bacon'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{Combining Data Structures}\label{combining-data-structures}

The following merges df and df2 using inner to get the intersection on
the Sample column, where indexes are ignored if the merging is performed
on a column as in the following example. The other possible merging
strategies are: left: use only keys from left frame, similar to a SQL
left outer join; preserve key order. right: use only keys from right
frame, similar to a SQL right outer join; preserve key order. outer: use
union of keys from both frames, similar to a SQL full outer join; sort
keys lexicographically. inner: use intersection of keys from both
frames, similar to a SQL inner join; preserve the order of the left
keys.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OperatorTok{=}\NormalTok{ pd.merge(df, df2, how}\OperatorTok{=}\StringTok{'inner'}\NormalTok{, on}\OperatorTok{=}\NormalTok{[}\StringTok{'Sample'}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

Appending to a Dataframe attaches a DataFrame after another one.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OperatorTok{=}\NormalTok{ pd.DataFrame([[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{], [}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{]], columns}\OperatorTok{=}\BuiltInTok{list}\NormalTok{(}\StringTok{'AB'}\NormalTok{))}
\NormalTok{df2 }\OperatorTok{=}\NormalTok{ pd.DataFrame([[}\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{], [}\DecValTok{7}\NormalTok{, }\DecValTok{8}\NormalTok{]], columns}\OperatorTok{=}\BuiltInTok{list}\NormalTok{(}\StringTok{'AB'}\NormalTok{))}
\NormalTok{df.append(df2)}
\end{Highlighting}
\end{Shaded}

\section{Summarizing}\label{summarizing}

The mean of column values can be calculated where each of the columns is
grouped by the data in a specified column.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temp[[}\StringTok{'Sample'}\NormalTok{,}\StringTok{'VAF'}\NormalTok{,}\StringTok{'Var_Count'}\NormalTok{]].groupby(}\StringTok{'Sample'}\NormalTok{).mean()}
\end{Highlighting}
\end{Shaded}

\section{Arithmetic and Row/Column-wise
Analysis}\label{arithmetic-and-rowcolumn-wise-analysis}

Sometimes it is helpful to analyze the value in a particular cell in a
conditional manner depending on it's value and then set the result of
this analysis to a corresponding cell in a new column. Here is an
example where the VAF of a variant is conditionally analyzed.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ LOH(x):}
    \ControlFlowTok{if}\NormalTok{ x }\OperatorTok{>} \FloatTok{0.75}\NormalTok{: }\ControlFlowTok{return} \DecValTok{1} \OperatorTok{-}\NormalTok{ x}
    \ControlFlowTok{elif}\NormalTok{ x }\OperatorTok{<=} \FloatTok{0.75} \KeywordTok{and}\NormalTok{ x }\OperatorTok{>} \FloatTok{0.25}\NormalTok{: }\ControlFlowTok{return} \BuiltInTok{abs}\NormalTok{(}\FloatTok{0.5} \OperatorTok{-}\NormalTok{ x)}
    \ControlFlowTok{else}\NormalTok{: }\ControlFlowTok{return} \DecValTok{0}
\NormalTok{all_vars[}\StringTok{'LOH'}\NormalTok{] }\OperatorTok{=}\NormalTok{ all_vars.VAF.transform(LOH)}
\NormalTok{max_loh }\OperatorTok{=}\NormalTok{ all_vars.groupby(}\StringTok{'Sample'}\NormalTok{).LOH.}\BuiltInTok{max}\NormalTok{().reset_index().rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{'LOH'}\NormalTok{:}\StringTok{'Max_LOH'}\NormalTok{\})}
\NormalTok{all_vars }\OperatorTok{=}\NormalTok{ pd.merge(all_vars, max_loh, how}\OperatorTok{=}\StringTok{'inner'}\NormalTok{, on}\OperatorTok{=}\NormalTok{[}\StringTok{'Sample'}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

Broadcasting arithmetic is an efficient method of calculating across an
entire DataFrame.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{frame }\OperatorTok{=}\NormalTok{ pd.DataFrame(np.arange(}\DecValTok{12}\NormalTok{.).reshape((}\DecValTok{4}\NormalTok{,}\DecValTok{3}\NormalTok{)), columns}\OperatorTok{=}\BuiltInTok{list}\NormalTok{(}\StringTok{'bde'}\NormalTok{), index}\OperatorTok{=}\NormalTok{[}\StringTok{'Utah'}\NormalTok{,}\StringTok{'Ohio'}\NormalTok{,}\StringTok{'Texas'}\NormalTok{,}\StringTok{'Oregon'}\NormalTok{]}
\NormalTok{series }\OperatorTok{=}\NormalTok{ frame.iloc[}\DecValTok{0}\NormalTok{]}
\NormalTok{frame }\OperatorTok{-}\NormalTok{ series}
\CommentTok{# the subtraction function could also be used}
\CommentTok{# frame.sub(series, axis='columns')}
\end{Highlighting}
\end{Shaded}

Apply a function to each row or column.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{f }\OperatorTok{=} \KeywordTok{lambda}\NormalTok{ x: x.}\BuiltInTok{max}\NormalTok{() }\OperatorTok{-}\NormalTok{ x.}\BuiltInTok{min}\NormalTok{()}
\NormalTok{frame.}\BuiltInTok{apply}\NormalTok{(f, axis}\OperatorTok{=}\StringTok{'index'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Add two sets of data together, and use fill\_value to avoid replacing
any missing data with \texttt{NaN}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OperatorTok{=}\NormalTok{ pd.DataFrame([}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{], columns}\OperatorTok{=}\BuiltInTok{list}\NormalTok{(}\StringTok{'0'}\NormalTok{))    }
\NormalTok{y }\OperatorTok{=}\NormalTok{ pd.DataFrame([}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{], columns}\OperatorTok{=}\BuiltInTok{list}\NormalTok{(}\StringTok{'1'}\NormalTok{))}
\NormalTok{x }\OperatorTok{=}\NormalTok{ x.add(y, fill_value}\OperatorTok{=}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Take the mean or std across specified columns and append as a new
column. Below the DataFrame has columns 1-7 that will be used in
computing the mean or std and this new data will be appended in a new
column labeled `Mean' or `Std'.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[}\StringTok{'Mean'}\NormalTok{]}\OperatorTok{=}\NormalTok{x[[}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{]].mean(axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
\NormalTok{x[}\StringTok{'Std'}\NormalTok{]}\OperatorTok{=}\NormalTok{x[[}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{]].std(axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\chapter{Git}\label{git}

\section{Setup}\label{setup}

\subsection{Git Setup}\label{git-setup}

The username and email needs to be added after git is installed.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{git}\NormalTok{ config --global user.name }\StringTok{"me"}
\FunctionTok{git}\NormalTok{ config --global user.email }\StringTok{"me@gmail.com"}
\end{Highlighting}
\end{Shaded}

After this information has been set, it can be checked.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{git}\NormalTok{ config --list}
\end{Highlighting}
\end{Shaded}

\subsection{Repository Initiation}\label{repository-initiation}

To setup a repository, create a folder with an initial file like a
README and then initiate it.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{git}\NormalTok{ init}
\FunctionTok{git}\NormalTok{ status}
\end{Highlighting}
\end{Shaded}

\subsection{Mirror on Online
Repository}\label{mirror-on-online-repository}

Create a repository on a repository like github, gitlab, bitbucket, or
sourceforge. Then the local git repository can be synched with the
online repository.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{git}\NormalTok{ remote add origin url-of-online-repository-here}
\FunctionTok{git}\NormalTok{ push -u origin master}
\end{Highlighting}
\end{Shaded}

Of course the repository could just be setup first and then cloned.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{git}\NormalTok{ clone url-of-online-repository-here}
\end{Highlighting}
\end{Shaded}

\section{Manipulating Commits}\label{manipulating-commits}

\subsection{Repository Status}\label{repository-status}

The commit history of a repository can be displayed in verbose form and
in summarized form.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{git}\NormalTok{ log}
\FunctionTok{git}\NormalTok{ log --oneline}
\end{Highlighting}
\end{Shaded}

\subsection{File Checkout}\label{file-checkout}

To restore a previous version of a file it can be checked out by first
identifying the version to be used using the log history and then
restoring the desired file.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{git}\NormalTok{ log --oneline}
\FunctionTok{git}\NormalTok{ checkout }\OperatorTok{<}\NormalTok{commit number}\OperatorTok{>}\NormalTok{ file.txt}
\end{Highlighting}
\end{Shaded}

\subsection{Resetting a Repository}\label{resetting-a-repository}

To discard the effect of the previous operation on a file.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{git}\NormalTok{ reset HEAD file.txt}
\end{Highlighting}
\end{Shaded}

The previous version of the a file can then be restored.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{git}\NormalTok{ checkout -- file.txt}
\end{Highlighting}
\end{Shaded}

\chapter{VIM}\label{vim}

\section{Formatting}\label{formatting}

Automatic newlines are inserted by default; this behavior can be
overidden with the following.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{:}\ExtensionTok{set}\NormalTok{ wrap}
\NormalTok{:}\ExtensionTok{set}\NormalTok{ textwidth=0 wrapmargin=0}
\end{Highlighting}
\end{Shaded}

\section{Spellcheck}\label{spellcheck}

To setup spellchecking first setup a personal dictionary file.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# make a directory for personal dictionary}
\FunctionTok{mkdir}\NormalTok{ -p ~/.vim/spell/}
\end{Highlighting}
\end{Shaded}

Then refer to the dictionary file within VIM, and enable spellchecking.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# set personal dictionary}
\NormalTok{:}\ExtensionTok{set}\NormalTok{ spellfile=~/.vim/spell/en.utf-8.add}
\CommentTok{# turn spellcheck on}
\NormalTok{:}\ExtensionTok{set}\NormalTok{ spell}
\end{Highlighting}
\end{Shaded}

Get spellcheck commands.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{:}\ExtensionTok{help}\NormalTok{ spell}
\end{Highlighting}
\end{Shaded}

Add a word to personal dictionary.

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{zg}
\end{Highlighting}
\end{Shaded}

Move to next and previous misspelled word.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{]}\ExtensionTok{s}
\NormalTok{[}\ExtensionTok{s}
\end{Highlighting}
\end{Shaded}

Get suggestions for misspelled word.

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{z=}
\end{Highlighting}
\end{Shaded}

\chapter{Bioinformatics Resources}\label{resources}

\section{Cancer Datasets}\label{cancer-datasets}

\begin{itemize}
\tightlist
\item
  \href{http://bionlp.bcgsc.ca/cancermine/}{CancerMine} is a site that
  mines publication data to create a database of mutations labeled as
  drivers, oncogenes, or tumor suppressors. These classifications may
  help to understand the evolution of different cancers.
\item
  \href{https://www.nature.com/articles/s41586-019-1186-3?WT.ec_id=NATURE-201905\&sap-outbound-id=720FBE4668F2FE14A299D42CB43EF50D90063A16\&mkt-key=005056A5C6311ED999AC3A52796F7641}{The
  Cancer Cell Line Encyclopedia} has a wealth of information from a
  large number of cancer cell lines.
\item
  \href{https://score.depmap.sanger.ac.uk/}{Project score} has a number
  of genetic screens that may be useful in identifying pathways that are
  critical to cancer growth and survival
\item
  \href{http://www.cbioportal.org/}{cbioportal} has information about
  codon changes in cancer but does not seem to have any sequence data
\item
  \href{https://dbgap.ncbi.nlm.nih.gov/aa/wga.cgi?page=login}{dbGAP} has
  info on genotypes and phenotypes, whatever the fuck that means

  \begin{itemize}
  \tightlist
  \item
    \href{https://dbgap.ncbi.nlm.nih.gov/aa/wga.cgi?page=login}{Here} is
    the page with instructions on how to get dbGAP access
  \end{itemize}
\item
  \href{https://www.cancer.gov/about-nci/organization/ccg/research/structural-genomics/tcga}{TCGA}

  \begin{itemize}
  \tightlist
  \item
    \href{https://gdc.cancer.gov/access-data/obtaining-access-controlled-data}{This}
    page has the instructions on how to get TCGA access
  \end{itemize}
\item
  \href{https://cancer.sanger.ac.uk/cosmic}{COSMIC}

  \begin{itemize}
  \tightlist
  \item
    Cosmic has a project called the
    \href{https://cancer.sanger.ac.uk/cosmic/census?genome=37}{Cancer
    Gene Census} in which they are trying to catalog all mutations that
    have been implicated in playing a causal role in cancer
  \item
    They also have implemented convenient
    \href{https://cancer.sanger.ac.uk/cosmic/help/file_download}{ways}
    of directly downloading information and files from the database in
    python using the files hosted
    \href{https://cancer.sanger.ac.uk/cosmic/download}{here}.
  \end{itemize}
\item
  \href{https://mastermind.genomenon.com/api}{Mastermind} from genomenon
  parsed all the articles on pubmed in order to find any and all
  information for each possible mutation
\item
  \href{https://gtexportal.org/home/}{GTEx} has RNA-Seq, Exome Seq,
  WGseq, SNP arrays, gene expression arrays and more for cancer and
  non-cancer?
\end{itemize}

\section{Alzheimer's}\label{alzheimers}

\begin{itemize}
\tightlist
\item
  \href{https://www.niagads.org/adsp/content/home}{The Alzheimers
  sequencing project} is gathering data to understand late onset
  alzheimer's
\end{itemize}

\section{Genome Resources}\label{genome-resources}

\begin{itemize}
\tightlist
\item
  Jax has a human to mouse gene matching
  \href{http://www.informatics.jax.org/downloads/reports/HOM_MouseHumanSequence.rpt}{list}
  that provides gene location matching between human and mouse
\item
  UCSC genome browser has an
  \href{http://genomewiki.ucsc.edu/index.php/Programmatic_access_to_the_Genome_Browser}{API}
  for programmatic access
\end{itemize}

\section{Genomic Datasets}\label{genomic-datasets}

\begin{itemize}
\tightlist
\item
  \href{ttps://www.joinallofus.org/en/how-to-join}{AllOfUs} is
  sequencing and collecting other health data on a million individuals
\item
  \href{https://www.color.com/}{Color Genomics} is one of three
  companies that will be doing the sequencing and testing for AllOfUs
\item
  \href{http://www.internationalgenome.org/data/}{1000 genomes}
\item
  \href{https://www.genomicsengland.co.uk/}{100,000 genomes}
\end{itemize}

\section{Computing Tools}\label{computing-tools}

\begin{itemize}
\tightlist
\item
  \href{https://aws.amazon.com/health/}{AWS} looks like it has some
  healthcare and life sciences resources
\end{itemize}

\section{Microbiome Datasets}\label{microbiome-datasets}

\begin{itemize}
\tightlist
\item
  \href{https://portal.hmpdacc.org/}{The Human Microbiome Project Data
  Portal} from Michael Snyder's group has longitudinal 'omics data that
  includes diseased and healthy timepoints.
\item
  Michael Snyder's \href{http://med.stanford.edu/ipop.html}{iPOP
  Personal 'Omics Profiling} has some interesting microbiome data
  specifically targeted to understanding diabetes.
\end{itemize}

\section{eQTL/RNASeq and other Tools}\label{eqtlrnaseq-and-other-tools}

\begin{itemize}
\tightlist
\item
  \href{https://adinasarapu.github.io/year-archive/}{Here} are a good
  number of general tools to check out
\item
  \href{https://github.com/molgenis/systemsgenetics/wiki/eQTL-mapping-analysis-cookbook-for-RNA-seq-data}{Here}
  is a good python eQTL analysis
\item
  \href{http://gn2.genenetwork.org/}{genenetwork2} has a great deal of
  data and eQTL mapping
  \href{https://github.com/genenetwork/genenetwork2}{tools}
\end{itemize}

\section{Other Data Resources}\label{other-data-resources}

\begin{itemize}
\tightlist
\item
  \href{http://www.earthmicrobiome.org/data-and-code/}{The Earth
  Microbiome Project} already has data available, and is trying to
  sequence all non-eukaryotic life on earth

  \begin{itemize}
  \tightlist
  \item
    They have detailed information about the project in their
    \href{http://www.pnas.org/content/115/17/4325.long}{PNAS paper} from
    2018
  \end{itemize}
\item
  \href{https://informationisbeautiful.net/}{Information is Beautiful}
  has some interesting datasets
\end{itemize}

\chapter{Golang}\label{golang}

\section{Installation}\label{installation}

Installation of linuxbrea

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sh}\NormalTok{ -c }\StringTok{"}\VariableTok{$(}\ExtensionTok{curl}\NormalTok{ -fsSL https://raw.githubusercontent.com/Linuxbrew/install/master/install.sh}\VariableTok{)}\StringTok{"}
\CommentTok{# Add to path}
\BuiltInTok{test}\NormalTok{ -d ~/.linuxbrew }\KeywordTok{&&} \BuiltInTok{eval} \VariableTok{$(}\ExtensionTok{~/.linuxbrew/bin/brew}\NormalTok{ shellenv}\VariableTok{)}
\BuiltInTok{test}\NormalTok{ -d /home/linuxbrew/.linuxbrew }\KeywordTok{&&} \BuiltInTok{eval} \VariableTok{$(}\ExtensionTok{/home/linuxbrew/.linuxbrew/bin/brew}\NormalTok{ shellenv}\VariableTok{)}
\BuiltInTok{test}\NormalTok{ -r ~/.bash_profile }\KeywordTok{&&} \BuiltInTok{echo} \StringTok{"eval }\DataTypeTok{\textbackslash{}$}\StringTok{(}\VariableTok{$(}\ExtensionTok{brew}\NormalTok{ --prefix}\VariableTok{)}\StringTok{/bin/brew shellenv)"} \OperatorTok{>>}\NormalTok{~/.bash_profile}
\BuiltInTok{echo} \StringTok{"eval }\DataTypeTok{\textbackslash{}$}\StringTok{(}\VariableTok{$(}\ExtensionTok{brew}\NormalTok{ --prefix}\VariableTok{)}\StringTok{/bin/brew shellenv)"} \OperatorTok{>>}\NormalTok{~/.profile}
\CommentTok{# debian/ubuntu dependencies}
\FunctionTok{sudo}\NormalTok{ apt-get install build-essential curl file git}
\end{Highlighting}
\end{Shaded}

LinuxBrew golang installation

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{brew}\NormalTok{ install go}
\end{Highlighting}
\end{Shaded}

The GO PATH should then be checked; it should typically exist at
\textasciitilde{}/go but it can be checked like this

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{echo} \VariableTok{$GOPATH}
\end{Highlighting}
\end{Shaded}

\section{Updating}\label{updating}

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{brew}\NormalTok{ install dep}
\ExtensionTok{brew}\NormalTok{ upgrade dep}
\ExtensionTok{brew}\NormalTok{ cask install spotify}
\end{Highlighting}
\end{Shaded}

\section{Sample Program}\label{sample-program}

Create a file called hello.go

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{package main}

\ImportTok{import} \StringTok{"fmt"}

\NormalTok{func main() \{}
\NormalTok{    fmt.Printf(}\StringTok{"hello, world}\CharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{\}}

\NormalTok{The program can just be run }\ControlFlowTok{with}
\NormalTok{go run main.go}

\NormalTok{Then }\BuiltInTok{compile}\NormalTok{ the program}
\NormalTok{    go build}

\NormalTok{Importing multiple things can be done on one line separated by a semicolon}
    \ImportTok{import}\NormalTok{ (}\StringTok{"fmt"}\OperatorTok{;} \StringTok{"math"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{Type conversion}\label{type-conversion}

Convert int to float64

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{var i }\BuiltInTok{int} \OperatorTok{=} \DecValTok{5}
\NormalTok{j :}\OperatorTok{=}\NormalTok{ float64(i)}
\end{Highlighting}
\end{Shaded}

int to string

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{s :}\OperatorTok{=}\NormalTok{ strconv.Itoa(}\DecValTok{97}\NormalTok{) }\OperatorTok{//}\NormalTok{ s }\OperatorTok{==} \StringTok{"97"}
\end{Highlighting}
\end{Shaded}

int64 to string

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{var n int64 }\OperatorTok{=} \DecValTok{97}
\NormalTok{s :}\OperatorTok{=}\NormalTok{ strconv.FormatInt(n, }\DecValTok{10}\NormalTok{) }\OperatorTok{//}\NormalTok{ s }\OperatorTok{==} \StringTok{"97"}\NormalTok{ (decimal) }\KeywordTok{in}\NormalTok{ base }\DecValTok{10}
\end{Highlighting}
\end{Shaded}

string to int

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{s :}\OperatorTok{=} \StringTok{"97"}
\ControlFlowTok{if}\NormalTok{ n, err :}\OperatorTok{=}\NormalTok{ strconv.Atoi(s)}\OperatorTok{;}\NormalTok{ err }\OperatorTok{==}\NormalTok{ nil \{}
\NormalTok{    fmt.Println(n}\OperatorTok{+}\DecValTok{1}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    fmt.Println(s, }\StringTok{"is not an integer."}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

string to int64

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{s :}\OperatorTok{=} \StringTok{"97"}
\NormalTok{n, err :}\OperatorTok{=}\NormalTok{ strconv.ParseInt(s, }\DecValTok{10}\NormalTok{, }\DecValTok{64}\NormalTok{)}
\ControlFlowTok{if}\NormalTok{ err }\OperatorTok{==}\NormalTok{ nil \{}
\NormalTok{    fmt.Printf(}\StringTok{"}\SpecialCharTok{%d}\StringTok{ of type %T"}\NormalTok{, n, n)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

int to int64

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{var n }\BuiltInTok{int} \OperatorTok{=} \DecValTok{97}
\NormalTok{m :}\OperatorTok{=}\NormalTok{ int64(n) }\OperatorTok{//}\NormalTok{ safe}
\end{Highlighting}
\end{Shaded}

\section{Strings}\label{strings}

Numbers can be converted to strings using strconv

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{s :}\OperatorTok{=}\NormalTok{ strconv.FormatFloat(}\FloatTok{3.1415}\NormalTok{, }\StringTok{'E'}\NormalTok{, }\OperatorTok{-}\DecValTok{1}\NormalTok{, }\DecValTok{64}\NormalTok{)}
\NormalTok{s :}\OperatorTok{=}\NormalTok{ strconv.FormatInt(}\OperatorTok{-}\DecValTok{42}\NormalTok{, }\DecValTok{16}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Strings can be assigned with ` ` or " ``, but only the double quotes can
use escape characters like newlines \n or \t

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fmt.Println(}\StringTok{"Hello}\CharTok{\textbackslash{}n}\StringTok{ World"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Indexing returns bytes rather than strings so they must be converted if
you want a string back

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{string(}\StringTok{"Hello World"}\NormalTok{[}\DecValTok{1}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

Test if a string is a substring of another

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import} \StringTok{"strings"}
\NormalTok{strings.Contains(}\StringTok{"something"}\NormalTok{,}\StringTok{"some"}\NormalTok{) }\OperatorTok{//}\NormalTok{ true}
\end{Highlighting}
\end{Shaded}

\section{Boolean Functions}\label{boolean-functions}

\begin{verbatim}
&&, ||, !, true, false
\end{verbatim}

\section{Variables}\label{variables}

Variables are statically typed and therefore must be declared when
assigned

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{var x string }\OperatorTok{=} \StringTok{"Hello World"}
\end{Highlighting}
\end{Shaded}

Type declaration can be offloaded to the compiler using the following
notation, and the compiler will try to infer the correct type

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{var x }\OperatorTok{=} \StringTok{"Hello World"}
\NormalTok{x :}\OperatorTok{=} \StringTok{"Hello World"}
\end{Highlighting}
\end{Shaded}

Constants are similar to variables, but their values cannot be
reassigned

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{const x string }\OperatorTok{=} \StringTok{"Hello"}
\end{Highlighting}
\end{Shaded}

Multiple variables can also be declared at once, where each variable
must occupy its own line

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{var (}
\NormalTok{    a }\OperatorTok{=} \DecValTok{5}
\NormalTok{    b }\OperatorTok{=} \DecValTok{10}
\NormalTok{    c }\OperatorTok{=} \DecValTok{15}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Substrings

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{s :}\OperatorTok{=} \StringTok{"something"}
\NormalTok{fmt.Println(s[:}\BuiltInTok{len}\NormalTok{(s)}\OperatorTok{-}\DecValTok{5}\NormalTok{])}
\NormalTok{fmt.Println(s[}\DecValTok{2}\NormalTok{:}\DecValTok{6}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\section{Input}\label{input}

User input

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{var }\BuiltInTok{input}\NormalTok{ float64}
\NormalTok{fmt.Scanf(}\StringTok{"}\SpecialCharTok{%f}\StringTok{"}\NormalTok{, }\OperatorTok{&}\BuiltInTok{input}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{Control Structures}\label{control-structures}

For loops can be written like the following

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{i :}\OperatorTok{=} \DecValTok{1}
\ControlFlowTok{for}\NormalTok{ i }\OperatorTok{<=} \DecValTok{10}\NormalTok{ \{}
\NormalTok{    fmt.Println(i)}
\NormalTok{    i }\OperatorTok{+=} \DecValTok{1}
\end{Highlighting}
\end{Shaded}

Probably the easier for loop is like this one

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ i :}\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{<=} \DecValTok{10}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++}\NormalTok{ \{}
\NormalTok{    fmt.Println(i)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

A nice for loop to iterate through a range

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ i :}\OperatorTok{=} \BuiltInTok{range}\NormalTok{ str1 \{}
    \ControlFlowTok{if}\NormalTok{ str1[i] }\OperatorTok{==}\NormalTok{ str2[i] \{ count}\OperatorTok{++}\NormalTok{ \}}
\NormalTok{\}}
\ControlFlowTok{return}\NormalTok{ count}
\end{Highlighting}
\end{Shaded}

For loops can be used to iterate through slices too

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ _, num :}\OperatorTok{=} \BuiltInTok{range}\NormalTok{ nums \{}
\end{Highlighting}
\end{Shaded}

If loops look gross, but it is required that the else statement is
placed where it is shown here

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ true \{}
\NormalTok{\} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ false \{}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Switches are also a thing

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{switch }\BuiltInTok{input}\NormalTok{ \{                          }
\NormalTok{    case }\DecValTok{1}\NormalTok{: fmt.Println(}\StringTok{"You entered one"}\NormalTok{)  }
\NormalTok{    case }\DecValTok{2}\NormalTok{: fmt.Println(}\StringTok{"You entered two"}\NormalTok{)  }
\NormalTok{    case }\DecValTok{3}\NormalTok{: fmt.Println(}\StringTok{"You entered three"}\NormalTok{)}
\NormalTok{\}                                           }
\end{Highlighting}
\end{Shaded}

\section{Data Structures}\label{data-structures}

A blank array

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{var x []}\BuiltInTok{int}
\end{Highlighting}
\end{Shaded}

An array with five elements

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{var x [}\DecValTok{5}\NormalTok{]}\BuiltInTok{int}
\NormalTok{x[}\DecValTok{0}\NormalTok{] }\OperatorTok{=} \DecValTok{50} \OperatorTok{//}\NormalTok{ the first element of the array equals }\DecValTok{50}
\end{Highlighting}
\end{Shaded}

An easier way to create an array and can be multiline broken by the
commas

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x :}\OperatorTok{=}\NormalTok{ [}\DecValTok{5}\NormalTok{]float64\{ }\DecValTok{98}\NormalTok{, }\DecValTok{93}\NormalTok{, }\DecValTok{77}\NormalTok{, }\DecValTok{82}\NormalTok{, }\DecValTok{83}\NormalTok{ \}}
\end{Highlighting}
\end{Shaded}

Slices can have variable lengths and are typically associated with an
array of fixed length. The following slice is 5 elements long, and is a
segment of a 10 element-long array

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x :}\OperatorTok{=}\NormalTok{ make([]float64, }\DecValTok{5}\NormalTok{, }\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

In a way that seems more similar to python, slicing an array can be done
like this

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{arr :}\OperatorTok{=}\NormalTok{ [}\DecValTok{5}\NormalTok{]float64\{}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{\}}
\NormalTok{x :}\OperatorTok{=}\NormalTok{ arr[}\DecValTok{0}\NormalTok{:}\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

Adding data to a slice

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{slice1 :}\OperatorTok{=}\NormalTok{ []}\BuiltInTok{int}\NormalTok{\{}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{\}}
\NormalTok{slice2 :}\OperatorTok{=}\NormalTok{ append(slice1,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Or multiple values can be added at once

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{s }\OperatorTok{=}\NormalTok{ append(s, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

A map is an unordered collection of key-value pairs (also known as a
dictionary). A map is defined by assigning it to a variable and then
defining the key type in brackets and the value type after the brackets

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{var x make(}\BuiltInTok{map}\NormalTok{[string]}\BuiltInTok{int}\NormalTok{)}
\NormalTok{x[}\StringTok{"key"}\NormalTok{] }\OperatorTok{=} \DecValTok{10} 
\NormalTok{fmt.Println(x)}
\end{Highlighting}
\end{Shaded}

Creating a map with multiple items simultaneously

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{elements :}\OperatorTok{=} \BuiltInTok{map}\NormalTok{[string]string\{}
  \StringTok{"H"}\NormalTok{:  }\StringTok{"Hydrogen"}\NormalTok{,}
  \StringTok{"He"}\NormalTok{: }\StringTok{"Helium"}\NormalTok{,}
  \StringTok{"Li"}\NormalTok{: }\StringTok{"Lithium"}\NormalTok{,}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Items can be deleted from a map using the delete function

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{delete(x, }\StringTok{"key"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Go provides functionality that checks whether a key lookup from a map
was successful or not

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m,n :}\OperatorTok{=}\NormalTok{ x[}\StringTok{"unknown"}\NormalTok{] }\OperatorTok{//}\NormalTok{ this key does }\KeywordTok{not}\NormalTok{ exist}
\NormalTok{fmt.Println(m,n) }\OperatorTok{//}\NormalTok{ m will equal }\DecValTok{0} \KeywordTok{and}\NormalTok{ n will equal false}
\end{Highlighting}
\end{Shaded}

This check can be used in an if loop to only run a chunk of code if a
key exists within a map. In the below code el equals the value and ok is
true or false, if the key is found, ok equals true and the print
statement is run

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ el, ok :}\OperatorTok{=}\NormalTok{ elements[}\StringTok{"Li"}\NormalTok{]}\OperatorTok{;}\NormalTok{ ok \{}
\NormalTok{fmt.Println(el[}\StringTok{"name"}\NormalTok{], el[}\StringTok{"state"}\NormalTok{])}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Iterate through a map

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ k, v :}\OperatorTok{=} \BuiltInTok{range}\NormalTok{ kmers \{                  }
\NormalTok{    fmt.Printf(}\StringTok{"key: }\SpecialCharTok{%s}\StringTok{ value: }\SpecialCharTok{%d}\CharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, k, v)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\section{Functions}\label{functions}

Below is a basic function that computes the mean of a map

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{func average(xs []float64) (float64) \{}
\NormalTok{    total :}\OperatorTok{=} \FloatTok{0.0}                      
    \ControlFlowTok{for}\NormalTok{ _, v :}\OperatorTok{=} \BuiltInTok{range}\NormalTok{ xs \{            }
\NormalTok{        total }\OperatorTok{+=}\NormalTok{ v                    }
\NormalTok{    \}}
    \ControlFlowTok{return}\NormalTok{ total }\OperatorTok{/}\NormalTok{ float64(}\BuiltInTok{len}\NormalTok{(xs))   }
\NormalTok{\}                                     }
\end{Highlighting}
\end{Shaded}

A function can also take multiple different types of variables

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{func lots_of_stuff(a }\BuiltInTok{int}\NormalTok{, b }\BuiltInTok{map}\NormalTok{[string]int64, c float64) (string, string, int64) \{}
\OperatorTok{//}\NormalTok{ do stuff}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

If it is desirable that a function takes maps of variable lengths a
function can be designed like the one below

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{func add(args ...}\BuiltInTok{int}\NormalTok{) }\BuiltInTok{int}\NormalTok{ \{ }
\NormalTok{    total :}\OperatorTok{=} \DecValTok{0}              
    \ControlFlowTok{for}\NormalTok{ _, v :}\OperatorTok{=} \BuiltInTok{range}\NormalTok{ args \{}
\NormalTok{        total }\OperatorTok{+=}\NormalTok{ v          }
\NormalTok{    \}                       }
    \ControlFlowTok{return}\NormalTok{ total            }
\NormalTok{\}  }
\end{Highlighting}
\end{Shaded}

Functions can also be placed within other functions like this

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{func main() \{}
\NormalTok{  add :}\OperatorTok{=}\NormalTok{ func(x, y }\BuiltInTok{int}\NormalTok{) }\BuiltInTok{int}\NormalTok{ \{}
    \ControlFlowTok{return}\NormalTok{ x }\OperatorTok{+}\NormalTok{ y}
\NormalTok{  \}}
\NormalTok{  fmt.Println(add(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Closure refers to functions that utilize non-local variables

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{func main() \{}
\NormalTok{  x :}\OperatorTok{=} \DecValTok{0}
\NormalTok{  increment :}\OperatorTok{=}\NormalTok{ func() }\BuiltInTok{int}\NormalTok{ \{}
\NormalTok{    x}\OperatorTok{++}
    \ControlFlowTok{return}\NormalTok{ x}
\NormalTok{  \}}
\NormalTok{  fmt.Println(increment())}
\NormalTok{  fmt.Println(increment())}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Recursion uses the same function recursively

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{//}\NormalTok{ a recursive function      }
\NormalTok{func factorial(x uint) uint \{}
    \ControlFlowTok{if}\NormalTok{ x }\OperatorTok{==} \DecValTok{0}\NormalTok{ \{              }
        \ControlFlowTok{return} \DecValTok{1}             
\NormalTok{    \}                        }
    \ControlFlowTok{return}\NormalTok{ x }\OperatorTok{*}\NormalTok{ factorial(x}\OperatorTok{-}\DecValTok{1}\NormalTok{)}
\NormalTok{\}      }
\end{Highlighting}
\end{Shaded}

Deferring essentially moves a function call to the end of a function,
like the following which closes the file after it is used

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{f, _ :}\OperatorTok{=}\NormalTok{ os.Open(filename)}
\NormalTok{defer f.Close()}
\end{Highlighting}
\end{Shaded}

\section{While loops}\label{while-loops}

These are not actually included in golang as in other languages but
instead utilize for loops.

This is a repeat-until loop:

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ \{}
\NormalTok{    work()}
    \ControlFlowTok{if}\NormalTok{ condition \{}
        \ControlFlowTok{break}
\NormalTok{    \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

or

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ ok :}\OperatorTok{=}\NormalTok{ true}\OperatorTok{;}\NormalTok{ ok}\OperatorTok{;}\NormalTok{ ok }\OperatorTok{=} \OperatorTok{!}\NormalTok{condition \{}
\NormalTok{    work()}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

A do-while loop

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ \{}
\NormalTok{    work()}
    \ControlFlowTok{if} \OperatorTok{!}\NormalTok{condition \{}
        \ControlFlowTok{break}
\NormalTok{    \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

or

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ ok :}\OperatorTok{=}\NormalTok{ true}\OperatorTok{;}\NormalTok{ ok}\OperatorTok{;}\NormalTok{ ok }\OperatorTok{=}\NormalTok{ condition \{}
\NormalTok{    work()}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\section{Timing a function}\label{timing-a-function}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{start :}\OperatorTok{=}\NormalTok{ time.Now()}
\NormalTok{t :}\OperatorTok{=}\NormalTok{ time.Now()}
\NormalTok{elapsed :}\OperatorTok{=}\NormalTok{ t.Sub(start)}
\NormalTok{fmt.Println(elapsed)}
\end{Highlighting}
\end{Shaded}

\section{Pointers}\label{pointers}

Pointers can be used to access the memory location of a variable and
alter the value stored in that location

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{func zero(xPtr }\OperatorTok{*}\BuiltInTok{int}\NormalTok{) \{                                              }
    \OperatorTok{*}\NormalTok{xPtr }\OperatorTok{=} \DecValTok{0} \OperatorTok{//}\NormalTok{ asterisk signifies a pointer                                                       }
\NormalTok{\}                                                                   }
                                                                    
\NormalTok{func main() \{                                                       }
\NormalTok{    x :}\OperatorTok{=} \DecValTok{5}                                                          
\NormalTok{    zero(}\OperatorTok{&}\NormalTok{x) }\OperatorTok{//} \OperatorTok{&}\NormalTok{ finds the address of a variable                                                       }
\NormalTok{    fmt.Println(x) }\OperatorTok{//}\NormalTok{ using a pointer allows the value to be changed}
\NormalTok{\}                                                                   }
\end{Highlighting}
\end{Shaded}

There is a built in function called new that takes a type as an
argument, and allocates sufficient memory to hold that type and returns
a pointer to it, and unlike other languages, because go is a garbage
collected language, it will delete anything created by new when nothing
refers to it anymore

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{func one(xPtr }\OperatorTok{*}\BuiltInTok{int}\NormalTok{) \{}
    \OperatorTok{*}\NormalTok{xPtr }\OperatorTok{=} \DecValTok{1}        
\NormalTok{\}}
                    
\NormalTok{func main() \{                                                                                                                 }
\NormalTok{    xPtr :}\OperatorTok{=}\NormalTok{ new(}\BuiltInTok{int}\NormalTok{)                                                }
\NormalTok{    one(xPtr)                                                       }
\NormalTok{    fmt.Println(}\OperatorTok{*}\NormalTok{xPtr)                                              }
\NormalTok{\}                                                                   }
\end{Highlighting}
\end{Shaded}

\section{Structures}\label{structures}

These seem similar to classes and allow a new `type' to be created

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{type}\NormalTok{ Circle struct \{}
\NormalTok{x float64}
\NormalTok{y float64}
\NormalTok{r float64}

    \OperatorTok{//}\NormalTok{ values of the same }\BuiltInTok{type}\NormalTok{ can be combined like this}
\NormalTok{    x, y, r float64 }
\NormalTok{\}                   }
\end{Highlighting}
\end{Shaded}

A new structure can be created just like a typical variable

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{var c Circle}
\end{Highlighting}
\end{Shaded}

A structure can be created like pointers which will set all values to
their zero value like 0, 0.0, ``'' and return a pointer

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{c :}\OperatorTok{=}\NormalTok{ new(Circle)}
\end{Highlighting}
\end{Shaded}

Values for a structure can also be defined at variable creation time

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{c :}\OperatorTok{=}\NormalTok{ Circle\{x: }\DecValTok{0}\NormalTok{, y: }\DecValTok{0}\NormalTok{, r: }\DecValTok{5}\NormalTok{\}}
\OperatorTok{//}\NormalTok{ this }\KeywordTok{is}\NormalTok{ possible }\ControlFlowTok{if}\NormalTok{ you remember the order }\BuiltInTok{vars}\NormalTok{ were defined}
\NormalTok{c :}\OperatorTok{=}\NormalTok{ Circle\{}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{5}\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Structure fields are accessed like class methods

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fmt.Println(c.x, c.y, c.r)}
\NormalTok{c.x }\OperatorTok{=} \DecValTok{10}
\NormalTok{c.y }\OperatorTok{=} \DecValTok{5}
\end{Highlighting}
\end{Shaded}

When passing a structure to another function, its type is the name of
the structure

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{func circleArea(c Circle) float64 \{}
    \ControlFlowTok{return}\NormalTok{ math.Pi }\OperatorTok{*}\NormalTok{ c.r }\OperatorTok{*}\NormalTok{ c.r     }
\NormalTok{\}                                  }
\end{Highlighting}
\end{Shaded}

Fields of a structure that has been defined are not altered unless a
pointer is used

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{func circleArea(c }\OperatorTok{*}\NormalTok{Circle) float64 \{}
\NormalTok{    c.r }\OperatorTok{=} \DecValTok{10}                        
    \ControlFlowTok{return}\NormalTok{ math.Pi }\OperatorTok{*}\NormalTok{ c.r }\OperatorTok{*}\NormalTok{ c.r      }
\NormalTok{\}                                   }
                                    
\NormalTok{func main() \{                       }
\NormalTok{    c:}\OperatorTok{=}\NormalTok{ Circle\{}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{5}\NormalTok{\}             }
\NormalTok{    fmt.Println(circleArea(}\OperatorTok{&}\NormalTok{c), c)  }
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\section{Methods}\label{methods}

These can be added to structures so they can be directly accessed by
automatically passing a pointer to the method. The area() receiver can
be used for other structures, and does not have to be a unique word

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{type}\NormalTok{ Circle struct \{             }
\NormalTok{    x, y, r float64              }
\NormalTok{\}                                }
                                 
\NormalTok{func (c }\OperatorTok{*}\NormalTok{Circle) area() float64 \{}
    \ControlFlowTok{return}\NormalTok{ math.Pi }\OperatorTok{*}\NormalTok{ c.r }\OperatorTok{*}\NormalTok{ c.r   }
\NormalTok{\}                                }
                                 
\NormalTok{func main() \{                    }
\NormalTok{    c:}\OperatorTok{=}\NormalTok{ Circle\{}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{5}\NormalTok{\}          }
\NormalTok{    fmt.Println(c.area())        }
\NormalTok{\}   }
\end{Highlighting}
\end{Shaded}

Embedded Types is sort of like inheritance and gives a method access to
all of the features of another structure.

Here is a person structure

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{type}\NormalTok{ Person struct \{}
\NormalTok{  Name string}
\NormalTok{\}}
\NormalTok{func (p }\OperatorTok{*}\NormalTok{Person) Talk() \{}
\NormalTok{  fmt.Println(}\StringTok{"Hi, my name is"}\NormalTok{, p.Name)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Here Android is defined to have the same properties as the person
structure

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{type}\NormalTok{ Android struct \{}
\NormalTok{  Person}
\NormalTok{  Model string}
\NormalTok{\}}

\NormalTok{a :}\OperatorTok{=}\NormalTok{ new(Android)}
\NormalTok{a.Talk()}
\end{Highlighting}
\end{Shaded}

\section{Packaging}\label{packaging}

Building code into a package is a convenient way of then accessing the
same methods without having to rebuild them.

To create a package, make a folder with the same name as the package so
\texttt{math} in this case. Then refer to the package name in a file
within this folder like this: package math

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{func Average(xs []float64) float64 \{}
\NormalTok{    total :}\OperatorTok{=}\NormalTok{ float64(}\DecValTok{0}\NormalTok{)             }
    \ControlFlowTok{for}\NormalTok{ _, x :}\OperatorTok{=} \BuiltInTok{range}\NormalTok{ xs \{          }
\NormalTok{        total }\OperatorTok{+=}\NormalTok{ x                  }
\NormalTok{    \}                               }
    \ControlFlowTok{return}\NormalTok{ total }\OperatorTok{/}\NormalTok{ float64(}\BuiltInTok{len}\NormalTok{(xs)) }
\NormalTok{\}                                   }
\end{Highlighting}
\end{Shaded}

Then save this file and build it from the same directory using:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{go install}
\end{Highlighting}
\end{Shaded}

Finally, use this package by referring to its directory like this:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{package main                          }
                                      
\ImportTok{import} \StringTok{"fmt"}                          
\OperatorTok{//} \ImportTok{import} \StringTok{"chapter11/math"} \OperatorTok{//}\NormalTok{this }\BuiltInTok{format}\NormalTok{ can be used }\ControlFlowTok{if}\NormalTok{ put }\KeywordTok{in} \OperatorTok{~/}\NormalTok{go}\OperatorTok{/}\NormalTok{src}\OperatorTok{/}
\ImportTok{import} \StringTok{"./math"}                       
                                      
\NormalTok{func main() \{                         }
\NormalTok{    xs :}\OperatorTok{=}\NormalTok{ []float64\{}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{\}          }
\NormalTok{    avg :}\OperatorTok{=}\NormalTok{ math.Average(xs)           }
\NormalTok{    fmt.Println(avg)                  }
\NormalTok{\}                                     }
\end{Highlighting}
\end{Shaded}

\section{Read/Write Files}\label{readwrite-files}

Here is how a file is opened

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{f, err :}\OperatorTok{=}\NormalTok{ os.Open(}\StringTok{"./data/genomes/schisto_small.fa"}\NormalTok{)}
\NormalTok{check(err)}
\NormalTok{f.Close() }\OperatorTok{//}\NormalTok{ when done}

\NormalTok{func check(e error) \{}
    \ControlFlowTok{if}\NormalTok{ e }\OperatorTok{!=}\NormalTok{ nil \{    }
\NormalTok{        panic(e)     }
\NormalTok{    \}                }
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Read by a certain number of bytes at a time

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{b1 :}\OperatorTok{=}\NormalTok{ make([]byte, }\DecValTok{61}\NormalTok{)                      }
\NormalTok{n1, err :}\OperatorTok{=}\NormalTok{ f.Read(b1)                       }
\NormalTok{check(err)                                  }
\NormalTok{fmt.Printf(}\StringTok{"}\SpecialCharTok{%d}\StringTok{ bytes: }\SpecialCharTok{%s}\CharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, n1, string(b1))}
\end{Highlighting}
\end{Shaded}

Peek might be more efficient with many small read calls but reads next n
bytes without advancing the reader

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{r4 :}\OperatorTok{=}\NormalTok{ bufio.NewReader(f)                                  }
\NormalTok{b4, err :}\OperatorTok{=}\NormalTok{ r4.Peek(}\DecValTok{61}\NormalTok{)                                    }
\NormalTok{check(err)                                                }
\NormalTok{fmt.Printf(}\StringTok{"5 bytes: }\SpecialCharTok{%s}\CharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, string(b4))}
\end{Highlighting}
\end{Shaded}

Scanners are useful ways to read newline delimited files

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{scanner :}\OperatorTok{=}\NormalTok{ bufio.NewScanner(f)                             }
\ControlFlowTok{for}\NormalTok{ scanner.Scan() \{                                       }
\NormalTok{    fmt.Println(scanner.Text()) }\OperatorTok{//}\NormalTok{ Println retains the }\OperatorTok{\textbackslash{}}\NormalTok{n  }
\NormalTok{\}                                                          }
\ControlFlowTok{if}\NormalTok{ err :}\OperatorTok{=}\NormalTok{ scanner.Err()}\OperatorTok{;}\NormalTok{ err }\OperatorTok{!=}\NormalTok{ nil \{                      }
\NormalTok{    fmt.Fprintln(os.Stderr, }\StringTok{"reading standard input:"}\NormalTok{, err)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Read from gzip file

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{(}\StringTok{"compress/gzip"}\NormalTok{)                                                          }
\BuiltInTok{file}\NormalTok{, err :}\OperatorTok{=}\NormalTok{ os.Open(}\StringTok{"./data/genomes/schisto_small_2.fa.gz"}\NormalTok{)}
\NormalTok{f, err :}\OperatorTok{=}\NormalTok{ gzip.NewReader(}\BuiltInTok{file}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\bibliography{book.bib,packages.bib}


\end{document}
